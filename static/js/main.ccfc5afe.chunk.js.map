{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.*/.entry/.js$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","UIListeners.ts","cards.ts","ClientApp.ts","charactermap.ts","Shared.tsx","components/Menu.tsx","pages/GamePage.tsx","pages/CardPage.tsx","pages/InteractionPage.tsx","pages/GameTab.tsx","pages/HelpPage.tsx","pages/Page.tsx","pages/PickCharacterPage.tsx","pages/LoginPage.tsx","pages/RoundComplete.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","LVListener","listenerType","tag","name","callback","prevValueStr","this","EventHandler","events","listenerId","properties","listener","p","undefined","push","i","length","splice","value","property","valueStr","listeners","list","registerListenerToMap","removeListenerFromMap","LVListenerList","values","item","orderedCards","CardDetailsMapValue","numInDeck","shortAction","action","cardType","cardDetailsMapExport","tokensToWinMap","cardTypesExport","getCardType","card","addCardTypes","cardStr","count","init","totalNumberOfCards","getCardDetails","cardTypeStr","clientApp","pickedCharacterId","alreadyPickedIds","playerId","numPlayers","key","username","roomcode","websocket","playerDetails","gameState","loggedIn","roomSeed","volume","prevUIData","hand","handIds","turnId","interaction","uiEventHandler","delayUiUpdates","gotoTab","audioMap","audioQueue","justDied","that","targetId","playedCard","status","url","localStorage","window","getItem","Math","floor","random","setItem","String","toLowerCase","Image","src","addAudio","audioUrl","audio","Audio","addEventListener","play","audioKey","setTimeout","rand","playAudio","setVolume","updateUI","v","setProperties","buildUIValues","register","clean","uiValues","addProperty","prop","cb","getCardDiscardedCountArray","getAlreadyPickedCharacterIds","nextUIValue","JSON","stringify","propertyChange","parse","toUpperCase","getAlphaIndex","str","index","charCodeAt","WebSocket","onopen","onmessage","event","data","onclose","triggerEvent","onerror","send","xhr","XMLHttpRequest","onload","response","room","open","setRequestHeader","characterId","selectedCharacterId","result","getCardDiscardedCount","j","total","discarded","jsonData","strData","prevInteractionStatus","cmd","addCard","pickup","state","wins","joinedPlayer","gotFullState","reveal","nextTurn","discard","newInteractionStatus","location","pathname","endsWith","intervalId","setInterval","clearInterval","players","player","playerStates","playerState","played","handCardId","target","guess","msg","prevGameState","gamestate","updatePlayerDetails","covertNumbersToCards","turn","prevStatus","otherCard","loserId","loser","revealedCard","swappedFor","swappedForCardId","prevCard","hiddenCard","finalCards","winnerIds","roundWinners","gameWinner","indexOf","playDiedAudio","discardCard","cardId","expose","charactersMap","LVCard","props","className","highlight","children","InteractionCard","CardName","CardImgAndDetails","Fragment","alt","PlayerCharacterName","PlayerCharacter","imgPath","PlayerState","DotDotDot","timerID","tick","setState","counter","resultStr","React","Component","appPages","title","icon","caretForwardCircleOutline","helpCircleOutline","Menu","useLocation","history","useHistory","useState","getUiProperty","setLoggedIn","setRoom","setPlayerDetails","setPlayerId","useEffect","onPropertyChange","onEvent","effectListeners","to","contentId","type","lines","detail","slot","codeOutline","appPage","startsWith","routerLink","routerDirection","onClick","toggleVolume","musicalNotesOutline","DiscardList","cards","Tokens","rng","Prando","seed","tokens","gemId","nextInt","hueRotate","rotate","gem","style","PlayerLine","dropdownOpen","hasDropdown","chevronUpOutline","chevronDownOutline","PlayersList","StartGameCard","allPicked","start","TopLine","roomCode","totalDiscards","discardedCardTotals","cardsLeft","GamePage","setDiscardedCardTotals","setGameState","setRoomSeed","setTurnId","fullscreen","PlayCard","playState","setPlayState","pickedTarget","setPickedTarget","waiting","setWaiting","handleBackClick","playCard","handId","disabled","anyValidTargets","targetList","targetPlayerDetails","guessCardType","CardPage","setHand","content","PlayerDiscard","PlayerEliminated","SecretReveal","InteractionContent","setInteraction","interactionBlock","turnPlayerDetails","hasTarget","waitingText","endTurn","otherDetails","interactionStep","winnerPlayerDetails","loserPlayerDetails","baronTurnPlayerCard","baronTargetPlayerCard","kingTurnPlayerCard","kingTargetPlayerCard","InteractionPage","GameTabPage","cardIcon","tabletPortraitOutline","isDead","exact","path","render","tab","href","accessibilityOutline","QuickHelpList","gotoSlideCb","handleClick","QuickHelpCard","HelpCardItems","HelpPage","slidesRef","useRef","handleGotoSlideCb","current","slideTo","ref","InputExamples","text","setText","number","setNumber","placeholder","onIonChange","clearInput","parseInt","readonly","position","PickCharacterElement","pickedCharacterCb","isAlreadyPicked","isSelected","isPicked","img","PickCharacterElements","characterImg","PickCharacterPage","setSelectedCharacterId","setAlreadyPickedIds","setPickedCharacterId","pickDisabled","setPickDisabled","pickCharacter","clearPickedCharacter","LoginPage","setName","joiningRoom","setJoiningRoom","createRoomEnable","setCreateRoomEnable","joinRoomEnable","setJoinRoomEnable","showToast","setShowToast","maxlength","autocapitalize","joinRoom","createRoom","isOpen","onDidDismiss","message","duration","RoundEndPlayersListItem","finalCard","RoundEndPlayersList","WinnersCards","handleNewRound","RoundCompletePage","App","GameTab","component","from","Boolean","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"uKAAA,IAAIA,EAAM,CACT,8BAA+B,CAC9B,GACA,GAED,uBAAwB,CACvB,GACA,GAED,uBAAwB,CACvB,GACA,GAED,0BAA2B,CAC1B,GACA,IAED,6BAA8B,CAC7B,GACA,IAED,0BAA2B,CAC1B,GACA,IAED,0BAA2B,CAC1B,GACA,IAED,wBAAyB,CACxB,GACA,IAED,0BAA2B,CAC1B,GACA,IAED,sBAAuB,CACtB,GACA,IAED,uBAAwB,CACvB,GACA,IAED,4BAA6B,CAC5B,GACA,IAED,uBAAwB,CACvB,GACA,IAED,qBAAsB,CACrB,GACA,IAED,mCAAoC,CACnC,GACA,IAED,uBAAwB,CACvB,GACA,IAED,+BAAgC,CAC/B,GACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,GAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASC,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEJ,EAAKE,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBP,EAAM,KAEjD,MADAM,EAAEE,KAAO,mBACHF,KAIR,IAAIG,EAAMX,EAAIE,GAAMU,EAAKD,EAAI,GAC7B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","file":"static/js/main.ccfc5afe.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t83,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t84,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t85,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t86,\n\t\t17\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t87,\n\t\t18\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t88,\n\t\t43\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t89,\n\t\t19\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t90,\n\t\t20\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t91,\n\t\t21\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t92,\n\t\t22\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t93,\n\t\t44\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t94,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t95,\n\t\t23\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t96,\n\t\t45\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t97,\n\t\t46\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t98,\n\t\t24\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t99,\n\t\t25\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t100,\n\t\t26\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t101,\n\t\t27\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t102,\n\t\t28\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t103,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t104,\n\t\t14\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t105,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t106,\n\t\t29\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t107,\n\t\t30\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t108,\n\t\t31\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t109,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t110,\n\t\t16\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t111,\n\t\t47\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t112,\n\t\t32\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t113,\n\t\t33\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t114,\n\t\t34\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t115,\n\t\t35\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t116,\n\t\t48\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t117,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t118,\n\t\t49\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t119,\n\t\t36\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t120,\n\t\t15\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t121,\n\t\t37\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t122,\n\t\t38\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t123,\n\t\t39\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t124,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t125,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 62;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t127,\n\t\t57\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 64;\nmodule.exports = webpackAsyncContext;","\r\nexport type UIChangeCallback = (value : any) => void;\r\n\r\nexport type LVUIProperty =\r\n    \"playerDetails\"\r\n    | \"hand\"\r\n    | \"discardedCardTotals\"\r\n    | \"playerId\"\r\n    | \"turnId\"\r\n    | \"interaction\"\r\n    | \"gameState\"\r\n    | \"loggedIn\"\r\n    | \"username\"\r\n    | \"roomcode\"\r\n    | \"pickedCharacterId\"\r\n    | \"alreadyPickedIds\"\r\n    | \"roomSeed\"\r\n    | \"volume\";\r\n\r\nexport type LVUIEvent =\r\n    \"leaveRoom\"\r\n    | \"connectionError\"\r\n    | \"joinRoom\"\r\n    | \"pickedCharacterInUse\"\r\n    | \"redirect\";\r\n\r\ntype LVListenerType = \"PROPERTY\" | \"EVENT\";\r\nexport class LVListener\r\n{\r\n    name : string;\r\n    id : number;\r\n    callback : UIChangeCallback;\r\n    listenerType : LVListenerType;\r\n    tag : string;\r\n    prevValueStr : string;\r\n\r\n    constructor(listenerType: LVListenerType, tag : string, name : string, callback : UIChangeCallback)\r\n    {\r\n        this.listenerType = listenerType;\r\n        this.tag = tag;\r\n        this.name = name;\r\n        this.callback = callback;\r\n        this.id = -1;\r\n        this.prevValueStr = \"\";\r\n    }\r\n}\r\n\r\ninterface UIEventMap {\r\n    [key: string]: LVListener[];\r\n}\r\n\r\nexport class EventHandler\r\n{\r\n    private events : UIEventMap;\r\n    private listenerId : number;\r\n    properties : UIEventMap;\r\n\r\n    constructor()\r\n    {\r\n        this.events = {};\r\n        this.properties = {};\r\n        this.listenerId = 0;\r\n    }\r\n\r\n    private registerListenerToMap(map: UIEventMap, listener : LVListener) : void\r\n    {\r\n        var p = map[listener.name];\r\n        if (p === undefined)\r\n        {\r\n            p = map[listener.name] = [];\r\n        }\r\n        this.listenerId += 1;\r\n        listener.id = this.listenerId;\r\n        p.push(listener);\r\n    }\r\n\r\n    private removeListenerFromMap(map: UIEventMap, listener : LVListener)\r\n    {\r\n        var p = map[listener.name];\r\n        if (p === undefined)\r\n        {\r\n            p = map[listener.name] = [];\r\n        }\r\n        var i;\r\n        for (i = 0; i < p.length; i += 1)\r\n        {\r\n            if (p[i].id === listener.id)\r\n            {\r\n                p.splice(i, 1);\r\n                return true;\r\n            }\r\n        }\r\n        throw Error(\"No listener with id \" + listener.id + \" found...\");\r\n        //return false;\r\n    }\r\n    \r\n    triggerEvent(name : LVUIEvent, value? : any)\r\n    {\r\n        var p = this.events[name];\r\n        var i : number;\r\n        for (i = 0; i < p.length; i += 1)\r\n        {\r\n            p[i].callback(value);\r\n        }\r\n    }\r\n\r\n    propertyChange(property : LVUIProperty, valueStr : string, value : any, tag : string)\r\n    {\r\n        var p = this.properties[property];\r\n        var i : number;\r\n        for (i = 0; i < p.length; i += 1)\r\n        {\r\n            if (tag.length === 0 || p[i].tag === tag)\r\n            {\r\n                if (p[i].prevValueStr !== valueStr)\r\n                {\r\n                    p[i].prevValueStr = valueStr;\r\n                    p[i].callback(value);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    register(listeners : LVListenerList)\r\n    {\r\n        var i;\r\n        for (i = 0; i < listeners.list.length; i += 1)\r\n        {\r\n            var map = listeners.list[i].listenerType === \"EVENT\" ? this.events : this.properties;\r\n            this.registerListenerToMap(map, listeners.list[i]);\r\n        }\r\n    }\r\n\r\n    clean(listeners : LVListenerList)\r\n    {\r\n        var i;\r\n        for (i = 0; i < listeners.list.length; i += 1)\r\n        {\r\n            var map = listeners.list[i].listenerType === \"EVENT\" ? this.events : this.properties;\r\n            this.removeListenerFromMap(map, listeners.list[i]);\r\n        }\r\n    }\r\n}\r\n\r\nexport class LVListenerList\r\n{\r\n    list : LVListener[];\r\n    tag : string;\r\n\r\n    constructor(tag : string)\r\n    {\r\n        this.list = [];\r\n        this.tag = tag;\r\n    }\r\n\r\n    setProperties(values : any)\r\n    {\r\n        var i;\r\n        for (i = 0; i < this.list.length; i += 1)\r\n        {\r\n            var item = this.list[i];\r\n            if (item.listenerType === \"PROPERTY\")\r\n            {\r\n                item.callback(values[item.name]);\r\n            }\r\n        }\r\n    }\r\n\r\n    onPropertyChange(name : LVUIProperty, callback : UIChangeCallback)\r\n    {\r\n        this.list.push(new LVListener(\"PROPERTY\", this.tag, name, callback));\r\n    }\r\n    onEvent(name : LVUIEvent, callback : UIChangeCallback)\r\n    {\r\n        this.list.push(new LVListener(\"EVENT\", this.tag, name, callback));\r\n    }\r\n}","export type CardType = \"GUARD\" | \"PRIEST\" | \"BARON\" | \"HANDMAID\" | \"PRINCE\" | \"KING\" | \"COUNTESS\" | \"PRINCESS\";\r\n\r\nexport const orderedCards : CardType[] = [\"GUARD\", \"PRIEST\", \"BARON\", \"HANDMAID\", \"PRINCE\", \"KING\", \"COUNTESS\", \"PRINCESS\"];\r\n\r\nclass CardDetailsMapValue {\r\n    value: number;\r\n    name: string;\r\n    numInDeck: number;\r\n    shortAction: string;\r\n    action: string;\r\n    cardType: CardType;\r\n    \r\n    constructor(map : {\r\n        value: number;\r\n        name: string;\r\n        numInDeck: number;\r\n        shortAction: string;\r\n        action: string;\r\n    }) {\r\n        this.value = map.value;\r\n        this.name = map.name;\r\n        this.numInDeck = map.numInDeck;\r\n        this.shortAction = map.shortAction;\r\n        this.action = map.action;\r\n        this.cardType = orderedCards[map.value];\r\n    }\r\n}\r\n\r\ninterface CardDetailsMap {\r\n    [key: string]: CardDetailsMapValue;\r\n}\r\n\r\nvar cardDetailsMapExport : CardDetailsMap = {\r\n    \"GUARD\":    new CardDetailsMapValue({ \"value\": 1, \"name\": \"Guard\", \"numInDeck\": 5,\r\n        \"shortAction\": \"Guess another players card (you cannot guess \\\"Guard\\\").\",\r\n        \"action\": \"Pick another player and guess their card type (you cannot guess \\\"Guard\\\"). If correct, the other player is eliminated.\" }),\r\n    \"PRIEST\":   new CardDetailsMapValue({ \"value\": 2, \"name\": \"Priest\", \"numInDeck\": 2,\r\n        \"shortAction\": \"Pick another player to privately see their hand.\",\r\n        \"action\": \"Pick another player to privately see their hand.\" }),\r\n    \"BARON\":    new CardDetailsMapValue({ \"value\": 3, \"name\": \"Baron\", \"numInDeck\": 2,\r\n        \"shortAction\": \"Pick another player and compare hands. Lowest value is eliminated.\",\r\n        \"action\": \"Pick another player and privately compare hands. The player with the lower-strength hand is eliminated.\" }),\r\n    \"HANDMAID\": new CardDetailsMapValue({ \"value\": 4, \"name\": \"Handmaid\", \"numInDeck\": 2,\r\n        \"shortAction\": \"You cannot be targeted until your next turn.\",\r\n        \"action\": \"You cannot be targeted until your next turn.\" }),\r\n    \"PRINCE\":   new CardDetailsMapValue({ \"value\": 5, \"name\": \"Prince\", \"numInDeck\": 2,\r\n        \"shortAction\": \"Pick any player to discard their hand and draw a new one.\",\r\n        \"action\": \"Pick any player (including yourself) to discard their hand and draw a new one. If they discard the Princess they are eliminated.\" }),\r\n    \"KING\":     new CardDetailsMapValue({ \"value\": 6, \"name\": \"King\", \"numInDeck\": 1,\r\n        \"shortAction\": \"Pick another player and trade hands with them.\",\r\n        \"action\": \"Pick another player and trade hands with them.\" }),\r\n    \"COUNTESS\": new CardDetailsMapValue({ \"value\": 7, \"name\": \"Countess\", \"numInDeck\": 1,\r\n        \"shortAction\": \"Must be played if your other card is a King or Prince.\",\r\n        \"action\": \"If your other card is a King or Prince card, this card must be played.\" }),\r\n    \"PRINCESS\": new CardDetailsMapValue({ \"value\": 8, \"name\": \"Princess\", \"numInDeck\": 1,\r\n        \"shortAction\": \"If you play this card for any reason, you are eliminated.\",\r\n        \"action\": \"If you play this card for any reason, you are eliminated from the round.\" }),\r\n};\r\n\r\nexport const tokensToWinMap : number[] = [ -1, -1, 7, 5, 4, 4, 4, 4, 4 ];\r\n\r\nvar cardTypesExport : string[] = [];\r\nfunction init()\r\n{\r\n    function addCardTypes(cardStr : string)\r\n    {\r\n        var i;\r\n        var count = cardDetailsMapExport[cardStr].numInDeck;\r\n        for (i = 0; i < count; i += 1)\r\n        {\r\n            cardTypesExport.push(cardStr);\r\n        }\r\n    }\r\n\r\n    var i;\r\n    for (i = 0; i < orderedCards.length; i += 1)\r\n    {\r\n        addCardTypes(orderedCards[i]);\r\n        cardDetailsMapExport[orderedCards[i]].cardType = orderedCards[i];\r\n    }\r\n}\r\ninit();\r\n\r\nexport function getCardType(card : number) : CardType\r\n{\r\n    return cardTypesExport[card] as CardType;\r\n}\r\n\r\nexport const totalNumberOfCards = cardTypesExport.length;\r\n\r\nexport function getCardDetails(cardTypeStr : CardType) : CardDetailsMapValue\r\n{\r\n    return cardDetailsMapExport[cardTypeStr as string];\r\n}","import { CardType, getCardType, orderedCards } from \"./cards\";\r\nimport { GameState, Interaction, PlayerDetails, Volume } from \"./Shared\";\r\nimport { EventHandler, LVListenerList, LVUIProperty } from \"./UIListeners\";\r\n\r\nexport type AudioKey =\r\n    \"attacked\" |\r\n    \"winner\" |\r\n    \"your_turn\" |\r\n    \"ding\" |\r\n    \"dead1\" |\r\n    \"dead2\" |\r\n    \"dead3\" |\r\n    \"dead_rare\";\r\n\r\ninterface AudioMap\r\n{\r\n    [key: string]: any;\r\n}\r\n\r\nclass ClientApp\r\n{\r\n    pickedCharacterId : number;\r\n    alreadyPickedIds : number[];\r\n    playerId : number;\r\n    numPlayers : number;\r\n    key: number | null;\r\n    username: string;\r\n    roomcode: string;\r\n    websocket: WebSocket | null;\r\n    playerDetails: PlayerDetails[];\r\n    gameState: GameState;\r\n    loggedIn: boolean;\r\n    roomSeed: number;\r\n    volume: Volume;\r\n\r\n    prevUIData: any;\r\n\r\n    hand : CardType[];\r\n    handIds : number[];\r\n    turnId : number;\r\n    interaction : Interaction;\r\n\r\n    uiEventHandler : EventHandler;\r\n    delayUiUpdates : boolean;\r\n    gotoTab : string | null;\r\n\r\n    audioMap : AudioMap;\r\n    audioQueue : any[];\r\n    justDied : boolean;\r\n\r\n    constructor()\r\n    {\r\n        var that = this;\r\n        this.uiEventHandler = new EventHandler();\r\n        this.delayUiUpdates = false;\r\n        this.gotoTab = null;\r\n\r\n        this.audioMap = {};\r\n        this.audioQueue = [];\r\n        this.justDied = false;\r\n\r\n        this.pickedCharacterId = -1;\r\n        this.alreadyPickedIds = [];\r\n        this.playerId = -1;\r\n        this.numPlayers = 0;\r\n        this.hand = [];\r\n        this.handIds = [];\r\n        this.turnId = -1;\r\n        this.playerDetails = [];\r\n        this.gameState = \"LOGIN\";\r\n        this.loggedIn = false;\r\n        this.interaction = {\r\n            playerId: -1,\r\n            targetId: -1,\r\n            playedCard: \"GUARD\",\r\n            status: null\r\n        };\r\n        this.roomSeed = 0;\r\n        \r\n        var localStorage = window.localStorage;\r\n\r\n        this.key = localStorage.getItem('key') as number | null;\r\n        if (!this.key)\r\n        {\r\n            this.key = Math.floor(Math.random() * 9999999);\r\n            localStorage.setItem('key', String(this.key));\r\n        }\r\n        this.username = localStorage.getItem('name') || \"\";\r\n        this.roomcode = localStorage.getItem('room') || \"\";\r\n        this.volume = <Volume>localStorage.getItem('volume') || \"HIGH\";\r\n\r\n        this.websocket = null;\r\n\r\n        this.prevUIData = {};\r\n\r\n        function preloadImage(url : string)\r\n        {\r\n            var img = new Image();\r\n            img.src = url;\r\n        }\r\n        var i;\r\n        for (i = 0; i < orderedCards.length; i += 1)\r\n        {\r\n            preloadImage(\"img/\" + orderedCards[i].toLowerCase() + \".png\");\r\n        }\r\n\r\n        function addAudio(key : AudioKey, audioUrl? : string)\r\n        {\r\n            var audio = new Audio(audioUrl ? audioUrl : \"audio/\" + key + \".wav\");\r\n            that.audioMap[key] = audio;\r\n            audio.addEventListener(\"ended\", function ()\r\n            {\r\n                that.audioQueue.splice(0, 1);\r\n                if (that.audioQueue.length > 0)\r\n                {\r\n                    that.audioMap[that.audioQueue[0]].play();\r\n                }\r\n            });\r\n        }\r\n        addAudio(\"attacked\");\r\n        addAudio(\"winner\", \"audio/winner.mp3\");\r\n        addAudio(\"your_turn\");\r\n        addAudio(\"ding\");\r\n        addAudio(\"dead1\");\r\n        addAudio(\"dead2\");\r\n        addAudio(\"dead3\", \"audio/dead3.mp3\");\r\n        addAudio(\"dead_rare\");\r\n    }\r\n\r\n    playAudio(audioKey : AudioKey)\r\n    {\r\n        if (this.audioQueue.length > 2)\r\n            return;\r\n\r\n        this.audioQueue.push(audioKey);\r\n        if (this.audioQueue.length === 1)\r\n        {\r\n            this.audioMap[this.audioQueue[0]].play();\r\n        }\r\n    }\r\n\r\n    playDiedAudio()\r\n    {\r\n        if (this.justDied)\r\n            return;\r\n\r\n        this.justDied = true;\r\n\r\n        var that = this;\r\n        // play with a small delay to add suspense\r\n        setTimeout(function ()\r\n        {\r\n            var rand = Math.random() * 100;\r\n            var audioKey : AudioKey = \"dead1\";\r\n            if (rand < 32)      audioKey = \"dead1\";\r\n            else if (rand < 64) audioKey = \"dead2\";\r\n            else if (rand < 96) audioKey = \"dead3\";\r\n            else                audioKey = \"dead_rare\";\r\n            that.playAudio(audioKey);\r\n            that.justDied = false;\r\n        }, 800);\r\n    }\r\n\r\n    toggleVolume()\r\n    {\r\n        if (this.volume === \"HIGH\")     this.volume = \"LOW\";\r\n        else if (this.volume === \"LOW\") this.volume = \"OFF\";\r\n        else if (this.volume === \"OFF\") this.volume = \"HIGH\";\r\n\r\n        if (this.volume === \"HIGH\")     this.setVolume(1.0);\r\n        else if (this.volume === \"LOW\") this.setVolume(0.3);\r\n        else if (this.volume === \"OFF\") this.setVolume(0.0);\r\n\r\n        this.updateUI();\r\n        this.playAudio(\"ding\");\r\n\r\n        var localStorage = window.localStorage;\r\n        localStorage.setItem('volume', this.volume);\r\n    }\r\n\r\n    setVolume(v : number)\r\n    {\r\n        var p : string;\r\n        for (p in this.audioMap)\r\n        {\r\n            this.audioMap[p].volume = v;\r\n        }\r\n    }\r\n\r\n    effectListeners(listeners : LVListenerList)\r\n    {\r\n        var that = this;\r\n        listeners.setProperties(this.buildUIValues(null));\r\n        this.uiEventHandler.register(listeners);\r\n        return function ()\r\n        {\r\n            that.uiEventHandler.clean(listeners);\r\n        };\r\n    }\r\n\r\n    buildUIValues(p : LVUIProperty | null) : any\r\n    {\r\n        var uiValues : any = {\r\n            playerDetails: this.playerDetails,\r\n            hand: this.hand,\r\n            playerId: this.playerId,\r\n            turnId: this.turnId,\r\n            interaction: this.interaction,\r\n            gameState: this.gameState,\r\n            loggedIn: this.loggedIn,\r\n            username: this.username,\r\n            roomcode: this.roomcode,\r\n            pickedCharacterId: this.pickedCharacterId,\r\n            roomSeed: this.roomSeed,\r\n            volume: this.volume,\r\n        };\r\n        function addProperty(prop : LVUIProperty, cb : any)\r\n        {\r\n            if (p === null || prop === p)\r\n            {\r\n                uiValues[prop] = cb();\r\n            }\r\n        }\r\n        addProperty(\"discardedCardTotals\", () => this.getCardDiscardedCountArray());\r\n        addProperty(\"alreadyPickedIds\", () => this.getAlreadyPickedCharacterIds());\r\n        return uiValues;\r\n    }\r\n\r\n    updateUI(tag : string = \"\")\r\n    {\r\n        if (this.delayUiUpdates && tag === \"\")\r\n            return;\r\n\r\n        var nextUIValue : any = this.buildUIValues(null);\r\n\r\n        var p : string;\r\n        for (p in this.uiEventHandler.properties)\r\n        {\r\n            var valueStr = JSON.stringify(nextUIValue[p])\r\n            this.uiEventHandler.propertyChange(p as LVUIProperty, valueStr, JSON.parse(valueStr), tag);\r\n            this.prevUIData[p] = valueStr;\r\n        }\r\n    }\r\n\r\n    getUiProperty(p : LVUIProperty)\r\n    {\r\n        return this.buildUIValues(p)[p];\r\n    }\r\n\r\n    resetGame()\r\n    {\r\n        this.hand = [];\r\n        this.handIds = [];\r\n        this.turnId = -1;\r\n    }\r\n\r\n    joinRoom(name : string, roomcode : string)\r\n    {\r\n        this.username = name;\r\n        this.roomcode = roomcode.toUpperCase();\r\n\r\n        var localStorage = window.localStorage;\r\n        localStorage.setItem('name', name);\r\n        localStorage.setItem('room', this.roomcode);\r\n        this.websocket = new WebSocket(\"wss://u72xrovjcj.execute-api.eu-west-2.amazonaws.com/test?room=\" + this.roomcode + \"&key=\" + this.key + \"&name=\" + this.username);\r\n\r\n        function getAlphaIndex(str : string, index : number)\r\n        {\r\n            return str.charCodeAt(0) - \"A\".charCodeAt(0);\r\n        }\r\n\r\n        this.roomSeed = 41 * (getAlphaIndex(this.roomcode, 0) +\r\n                            (getAlphaIndex(this.roomcode, 1) * 26 +\r\n                            (getAlphaIndex(this.roomcode, 2) * 26 +\r\n                            (getAlphaIndex(this.roomcode, 3) * 26))));\r\n\r\n        var that = this;\r\n        this.websocket.onopen = function (/*event*/) {\r\n            that.onopen();\r\n        };\r\n        this.websocket.onmessage = function (event) {\r\n            that.onmessage(event.data);\r\n        };\r\n        this.websocket.onclose = function (/*event*/) {\r\n            that.uiEventHandler.triggerEvent(\"leaveRoom\");\r\n            that.gameState = \"LOGIN\";\r\n            that.loggedIn = false;\r\n            that.updateUI();\r\n        };\r\n        this.websocket.onerror = function (/*event*/) {\r\n            that.uiEventHandler.triggerEvent(\"connectionError\", that.roomcode + \"\");\r\n            that.roomcode = \"\";\r\n            that.loggedIn = false;\r\n            that.updateUI();\r\n        };\r\n    }\r\n\r\n    onopen()\r\n    {\r\n        this.send({ \"cmd\": \"GET\" });\r\n        this.loggedIn = true;\r\n        this.updateUI();\r\n    }\r\n\r\n    createRoom()\r\n    {\r\n        var that = this;\r\n        var xhr = new XMLHttpRequest();\r\n        function reqListener ()\r\n        {\r\n            try\r\n            {\r\n                var data = JSON.parse(xhr.response);\r\n                that.roomcode = data.room;\r\n                that.updateUI();\r\n            }\r\n            catch (e)\r\n            {\r\n            }\r\n        }\r\n\r\n        xhr.onload = reqListener;\r\n        xhr.open(\"GET\", 'https://bzlzgmgcuh.execute-api.eu-west-2.amazonaws.com/default/loveletter-create');\r\n        xhr.setRequestHeader(\"Content-Type\", \"text/plain\");\r\n        xhr.send();\r\n    }\r\n\r\n    getAlreadyPickedCharacterIds()\r\n    {\r\n        this.alreadyPickedIds = [];\r\n\r\n        var i;\r\n        var playerDetails;\r\n        for (i = 0; i < this.playerDetails.length; i += 1)\r\n        {\r\n            playerDetails = this.playerDetails[i];\r\n            if (i === this.playerId)\r\n                continue;\r\n            if (playerDetails.characterId !== -1)\r\n                this.alreadyPickedIds.push(playerDetails.characterId);\r\n        }\r\n        return this.alreadyPickedIds;\r\n    }\r\n\r\n    pickCharacter(selectedCharacterId : number)\r\n    {\r\n        this.send({ \"cmd\": \"PICK_CHARACTER\", \"characterId\": selectedCharacterId });\r\n    }\r\n\r\n    clearPickedCharacter()\r\n    {\r\n        this.send({ \"cmd\": \"CLEAR_PICKED_CHARACTER\" });\r\n    }\r\n\r\n    getCardDiscardedCountArray()\r\n    {\r\n        var result = [];\r\n        var i;\r\n        for (i = 0; i < orderedCards.length; i += 1)\r\n        {\r\n            result[i] = this.getCardDiscardedCount(orderedCards[i]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getCardDiscardedCount(cardStr : CardType)\r\n    {\r\n        var i;\r\n        var j;\r\n        var total = 0;\r\n        for (i = 0; i < this.playerDetails.length; i += 1)\r\n        {\r\n            var discarded : CardType[] = this.playerDetails[i].discarded;\r\n            for (j = 0; j < discarded.length; j += 1)\r\n            {\r\n                if (discarded[j] === cardStr)\r\n                    total += 1;\r\n            }\r\n        }\r\n        return total;\r\n    }\r\n\r\n    send(jsonData : any)\r\n    {\r\n        jsonData[\"room\"] = this.roomcode;\r\n        this.websocket!.send(JSON.stringify(jsonData));\r\n    }\r\n\r\n    start()\r\n    {\r\n        this.send({ \"cmd\": \"START\" });\r\n    }\r\n    /*\r\n    restart()\r\n    {\r\n        this.send({ \"cmd\": \"RESTART\" });\r\n    }\r\n\r\n    forceRoundEnd()\r\n    {\r\n        this.send({ \"cmd\": \"FORCE_ROUND_END\" });\r\n    }\r\n\r\n    */\r\n    onmessage(strData : string)\r\n    {\r\n        var prevInteractionStatus = this.interaction.status;\r\n        if (prevInteractionStatus === \"CONTINUE\")\r\n            prevInteractionStatus = \"REVEAL\";\r\n\r\n        var data = JSON.parse(strData);\r\n        switch(data.cmd) {\r\n            case \"CHARACTER_ID_IN_USE\":\r\n                this.uiEventHandler.triggerEvent(\"pickedCharacterInUse\");\r\n            break;\r\n            case \"CHARACTER_PICKED\":\r\n                this.playerDetails[data.playerId].characterId = data.characterId;\r\n                if (data.playerId === this.playerId)\r\n                {\r\n                    this.pickedCharacterId = data.characterId;\r\n                    this.uiEventHandler.triggerEvent(\"redirect\", \"/tabs/game\");\r\n                }\r\n            break;\r\n            case \"CLEAR_CHARACTER_PICK\":\r\n                this.playerDetails[data.playerId].characterId = -1;\r\n            break;\r\n            case \"START_CARD\":\r\n                this.playerId = data.playerId;\r\n                this.addCard(data.pickup);\r\n            break;\r\n            case \"YOUR_TURN\":\r\n                this.playAudio(\"your_turn\");\r\n            // intentional fallthrough\r\n            case \"PICKUP\":\r\n                // clear your SAFE state\r\n                this.playerDetails[this.playerId].state = \"ALIVE\";\r\n                this.addCard(data.pickup);\r\n            break;\r\n            case \"JOINED\":\r\n                if (data.index >= this.playerDetails.length)\r\n                {\r\n                    this.playerDetails[data.index] = {\r\n                        name: data.name,\r\n                        characterId: (data.characterId === undefined || data.characterId === null) ? -1 : data.characterId,\r\n                        wins: 0,\r\n                        state: \"ALIVE\",\r\n                        discarded: []\r\n                    };\r\n                }\r\n                else\r\n                {\r\n                    var joinedPlayer = this.playerDetails[data.index];\r\n                    joinedPlayer.name = data.name;\r\n                    joinedPlayer.characterId = (data.characterId === undefined || data.characterId === null) ? -1 : data.characterId;\r\n                }\r\n            break;\r\n            case \"NEXT_ROUND\":\r\n            case \"START_GAME\":\r\n            case \"STATE\":\r\n            case \"PLAYED\":\r\n            case \"END_TURN\":\r\n            case \"ROUND_COMPLETE\":\r\n                this.gotFullState(data);\r\n            break;\r\n            case \"REVEALED\":\r\n                this.interaction.status = \"CONTINUE\";\r\n                this.reveal();\r\n            break;\r\n            case \"NEXT_TURN\":\r\n                this.nextTurn(data);\r\n            break;\r\n            case \"DISCARD\":\r\n                this.discard(data);\r\n            break;\r\n        }\r\n\r\n        var newInteractionStatus = this.interaction.status;\r\n        if (newInteractionStatus === \"CONTINUE\")\r\n            newInteractionStatus = \"REVEAL\";\r\n\r\n        if (newInteractionStatus !== prevInteractionStatus)\r\n        {\r\n            var gotoTab : string | undefined;\r\n            if (this.interaction.status !== null)\r\n            {\r\n                if (this.interaction.status === \"ROUND_COMPLETE\")\r\n                {\r\n                    this.updateUI(\"roundComplete\");\r\n                    gotoTab = \"/page/RoundComplete\";\r\n                }\r\n                else\r\n                {\r\n                    this.updateUI(\"interaction\");\r\n                    gotoTab = \"/tabs/interaction\";\r\n                }\r\n            }\r\n            else if (window.location.pathname.endsWith(\"/tabs/interaction\") ||\r\n                     window.location.pathname.endsWith(\"/page/RoundComplete\"))\r\n            {\r\n                this.updateUI(\"game\");\r\n                gotoTab = \"/tabs/game\";\r\n            }\r\n            \r\n            if (gotoTab)\r\n            {\r\n                this.delayUiUpdates = true; // delay any UI updates until the page has changed...\r\n\r\n                var that = this;\r\n                this.gotoTab = gotoTab;\r\n                setTimeout(function ()\r\n                {\r\n                    // once the page UI has updated switch to it\r\n                    that.uiEventHandler.triggerEvent(\"redirect\", that.gotoTab);\r\n                    var intervalId = setInterval(function ()\r\n                    {\r\n                        if (window.location.pathname.endsWith(that.gotoTab!))\r\n                        {\r\n                            that.gotoTab = null;\r\n                            that.delayUiUpdates = false;\r\n                            that.updateUI();\r\n                            clearInterval(intervalId!);\r\n                        }\r\n                    }, 10);\r\n                }, 1);\r\n            }\r\n        }\r\n\r\n        this.updateUI();\r\n    }\r\n    \r\n    updatePlayerDetails(data : any)\r\n    {\r\n        this.playerDetails = [];\r\n        var i;\r\n        for (i = 0; i < data.players.length; i += 1)\r\n        {\r\n            var player = data.players[i];\r\n            var playerDetails : PlayerDetails = {\r\n                name: player.name,\r\n                characterId: (player.characterId === null || player.characterId === undefined) ? -1 : player.characterId,\r\n                wins: 0,\r\n                state: \"ALIVE\",\r\n                discarded: []\r\n            };\r\n\r\n            if (data.playerStates)\r\n            {\r\n                var playerState = data.playerStates[i];\r\n                playerDetails.wins = playerState.wins;\r\n                var j;\r\n                for (j = 0; j < playerState.played.length; j += 1)\r\n                {\r\n                    playerDetails.discarded.push(getCardType(playerState.played[j]));\r\n                }\r\n                playerDetails.state = playerState.state;\r\n            }\r\n\r\n            if (this.playerId === i)\r\n            {\r\n                this.pickedCharacterId = (player.characterId === null || player.characterId === undefined) ? -1 : player.characterId;\r\n            }\r\n\r\n            this.playerDetails.push(playerDetails);\r\n        }\r\n    }\r\n\r\n    playCard(handCardId : number, target? : number, guess? : CardType)\r\n    {\r\n        var cmd;\r\n        if (handCardId === 0)\r\n            cmd = \"PLAY_HAND\";\r\n        else if (handCardId === 1)\r\n            cmd = \"PLAY_PICKUP\";\r\n\r\n        var msg : any = { \"room\": this.roomcode, \"cmd\": cmd };\r\n        if (target !== undefined)\r\n            msg[\"target\"] = target;\r\n        if (guess !== undefined)\r\n            msg[\"guess\"] = guess;\r\n        this.send(msg);\r\n        this.delayUiUpdates = true; // delay any UI updates until the page has changed to interaction...\r\n    }\r\n\r\n    gotFullState(data : any)\r\n    {\r\n        if (data.playerId !== undefined)\r\n            this.playerId = data.playerId;\r\n        this.numPlayers = data.players.length;\r\n\r\n        var prevGameState = this.gameState;\r\n        this.gameState = data.gamestate;\r\n        \r\n        if (prevGameState === \"LOGIN\")\r\n        {\r\n            this.uiEventHandler.triggerEvent(\"redirect\", (data.gamestate === \"LOGIN\") ? \"/page/PickCharacter\" : \"/tabs\");\r\n        }\r\n\r\n        if (data.gamestate === \"LOGIN\")\r\n        {\r\n            this.updatePlayerDetails(data);\r\n        }\r\n        else if (data.gamestate === \"PLAYING\")\r\n        {\r\n            this.handIds = data.hand || [];\r\n            this.hand = this.covertNumbersToCards(data.hand || []);\r\n            this.turnId = data.turn;\r\n            var prevStatus = this.interaction.status;\r\n            if (data.interaction.state === undefined)\r\n            {\r\n                this.interaction.status = null;\r\n            }\r\n            else\r\n            {\r\n                this.interaction = {\r\n                    playerId: data.interaction.playerId,\r\n                    playedCard: getCardType(data.interaction.card),\r\n                    otherCard: getCardType(data.interaction.otherCard),\r\n                    status: data.interaction.state,\r\n                    guess: data.interaction.guess,\r\n                    result: data.interaction.result,\r\n                    targetId: data.interaction.target,\r\n                    loserId: data.interaction.loser,\r\n                    revealedCard: getCardType(data.interaction.revealedCard),\r\n                    discard: getCardType(data.interaction.discard),\r\n                    swappedFor: getCardType(data.interaction.swappedFor),\r\n                    swappedForCardId: data.interaction.swappedFor,\r\n                    prevCard: getCardType(data.interaction.prevCard),\r\n\r\n                    // round end state\r\n                    hiddenCard: getCardType(data.interaction.hiddenCard),\r\n                    finalCards: this.covertNumbersToCards(data.interaction.finalCards || []),\r\n                    winnerIds: data.interaction.roundWinners,\r\n                    gameWinner: data.interaction.gameWinner\r\n                };\r\n\r\n                if (prevStatus === null && this.interaction.targetId === this.playerId)\r\n                {\r\n                    this.playAudio(\"attacked\");\r\n                }\r\n\r\n                if (this.interaction.winnerIds && this.interaction.winnerIds.indexOf(this.playerId) !== -1)\r\n                {\r\n                    this.playAudio(\"winner\");\r\n                }\r\n                \r\n                if (this.interaction.status === \"CONTINUE\" && (\r\n                    (this.playerId === this.interaction.targetId && this.interaction.result === \"CORRECT_GUESS\") ||\r\n                    (this.playerId === this.interaction.loserId)))\r\n                {\r\n                    this.playDiedAudio();\r\n                }\r\n                else if (this.playerId === this.interaction.playerId && this.interaction.playedCard === \"PRINCESS\")\r\n                {\r\n                    this.playDiedAudio();\r\n                }\r\n            }\r\n            this.updatePlayerDetails(data);\r\n        }\r\n    }\r\n\r\n    covertNumbersToCards(data : number[]) : CardType[]\r\n    {\r\n        var result : CardType[] = [];\r\n        var i;\r\n        for (i = 0; i < data.length; i += 1)\r\n        {\r\n            result.push(getCardType(data[i]));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    discard(data : any)\r\n    {\r\n        var playerDetails = this.playerDetails[data.playerId];\r\n        var discardCard : CardType = getCardType(data.card);\r\n        if (data.playerId === this.playerId)\r\n        {\r\n            if (discardCard === \"PRINCESS\")\r\n            {\r\n                this.playDiedAudio();\r\n            }\r\n            \r\n            if (!data.played)\r\n            {\r\n                var i;\r\n                for (i = 0; i < this.handIds.length; i += 1)\r\n                {\r\n                    if (data.card === this.handIds[i])\r\n                    {\r\n                        playerDetails.discarded.push(discardCard);\r\n                        this.hand.splice(i, 1);\r\n                        this.handIds.splice(i, 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            playerDetails.discarded.push(discardCard);\r\n        }\r\n    }\r\n\r\n    nextTurn(data : any)\r\n    {\r\n        this.turnId = data.turn;\r\n        this.interaction.status = null;\r\n        // clear the SAFE state\r\n        this.playerDetails[this.turnId].state = \"ALIVE\";\r\n    }\r\n\r\n    addCard(cardId : number)\r\n    {\r\n        var i;\r\n        for (i = 0; i < this.handIds.length; i += 1)\r\n        {\r\n            if (cardId === this.handIds[i])\r\n            {\r\n                return;\r\n            }\r\n        }\r\n        this.hand.push(getCardType(cardId));\r\n        this.handIds.push(cardId);\r\n    }\r\n\r\n    roundComplete(data : any)\r\n    {\r\n        \r\n    }\r\n\r\n    /*\r\n    getOtherCard()\r\n    {\r\n        var i;\r\n        for (i = 0; i < 2; i += 1)\r\n        {\r\n            if (this.hand[i] !== this.interaction.card)\r\n                return this.hand[i];\r\n        }\r\n        return this.hand[0];\r\n    }\r\n    */\r\n    interactionStep()\r\n    {\r\n        if (this.interaction.status === \"CONTINUE\" ||\r\n            this.interaction.status === \"ROUND_COMPLETE\")\r\n        {\r\n            // wait for the page to change before updating any UI\r\n            this.delayUiUpdates = true;\r\n        }\r\n        this.send({\"cmd\": this.interaction.status});\r\n    }\r\n\r\n    reveal()\r\n    {\r\n        if (this.turnId === this.playerId)\r\n        {\r\n            this.playAudio(\"ding\");\r\n        }\r\n        else if (this.interaction.status === \"CONTINUE\" && (\r\n                (this.playerId === this.interaction.targetId && this.interaction.result === \"CORRECT_GUESS\") ||\r\n                (this.playerId === this.interaction.loserId)))\r\n        {\r\n            this.playDiedAudio();\r\n        }\r\n\r\n        if (this.interaction.playedCard === \"KING\" && this.interaction.swappedForCardId !== undefined)\r\n        {\r\n            this.hand[0] = this.interaction.swappedFor!;\r\n            this.handIds[0] = this.interaction.swappedForCardId!;\r\n        }\r\n    }\r\n}\r\n\r\nexport let clientApp = new ClientApp();\r\n\r\ndeclare global {\r\n    interface Window { expose: any; }\r\n}\r\nwindow.expose = { clientApp: clientApp };\r\n","export const charactersMap : string[] = [\r\n    \"001-centaur.svg\",\r\n    \"002-kraken.svg\",\r\n    \"003-dinosaur.svg\",\r\n    \"004-tree-1.svg\",\r\n    \"005-hand.svg\",\r\n    \"006-echidna.svg\",\r\n    \"007-robot.svg\",\r\n    \"008-mushroom.svg\",\r\n    \"009-harpy.svg\",\r\n    \"010-phoenix.svg\",\r\n    \"011-dragon-1.svg\",\r\n    \"012-devil.svg\",\r\n    \"013-troll.svg\",\r\n    \"014-alien.svg\",\r\n    \"015-minotaur.svg\",\r\n    \"016-madre-monte.svg\",\r\n    \"017-satyr.svg\",\r\n    \"018-karakasakozou.svg\",\r\n    \"019-pirate.svg\",\r\n    \"020-werewolf.svg\",\r\n    \"021-scarecrow.svg\",\r\n    \"022-valkyrie.svg\",\r\n    \"023-curupira.svg\",\r\n    \"024-loch-ness-monster.svg\",\r\n    \"025-tree.svg\",\r\n    \"026-cerberus.svg\",\r\n    \"027-gryphon.svg\",\r\n    \"028-mermaid.svg\",\r\n    \"029-vampire.svg\",\r\n    \"030-goblin.svg\",\r\n    \"031-yeti.svg\",\r\n    \"032-leprechaun.svg\",\r\n    \"033-medusa.svg\",\r\n    \"034-chimera.svg\",\r\n    \"035-elf.svg\",\r\n    \"036-hydra.svg\",\r\n    \"037-cyclops.svg\",\r\n    \"038-pegasus.svg\",\r\n    \"039-narwhal.svg\",\r\n    \"040-woodcutter.svg\",\r\n    \"041-zombie.svg\",\r\n    \"042-dragon.svg\",\r\n    \"043-frankenstein.svg\",\r\n    \"044-witch.svg\",\r\n    \"045-fairy.svg\",\r\n    \"046-genie.svg\",\r\n    \"047-pinocchio.svg\",\r\n    \"048-ghost.svg\",\r\n    \"049-wizard.svg\",\r\n    \"050-unicorn.svg\",\r\n];\r\n","import React from 'react';\r\nimport { getCardDetails, CardType } from './cards';\r\nimport { charactersMap } from './charactermap';\r\n\r\nexport type GameState = \"LOGIN\" | \"PLAYING\";\r\nexport type PlayerStatus = \"ALIVE\" | \"DEAD\" | \"SAFE\";\r\nexport type Volume = \"HIGH\" | \"LOW\" | \"OFF\";\r\nexport type DiscardedCardTotals = number[];\r\n\r\nexport interface PlayerDetails {\r\n    name: string;\r\n    characterId: number;\r\n    state: PlayerStatus;\r\n    wins: number;\r\n    discarded: CardType[];\r\n}\r\n\r\nexport interface Interaction {\r\n    playerId: number;\r\n    playedCard: CardType;\r\n    status: \"REVEAL\" | \"CONTINUE\" | \"ROUND_COMPLETE\" | null;\r\n    targetId?: number;\r\n    guess?: CardType;\r\n    result?: \"CORRECT_GUESS\" | \"TIE\";\r\n    loserId?: number;\r\n    revealedCard?: CardType;\r\n    otherCard?: CardType;\r\n    discard?: CardType;\r\n    swappedFor?: CardType;\r\n    swappedForCardId?: number;\r\n    prevCard?: CardType;\r\n    \r\n    // round end state\r\n    hiddenCard?: CardType;\r\n    finalCards?: CardType[];\r\n    winnerIds?: number[];\r\n    gameWinner?: number;\r\n}\r\n\r\nexport function LVCard(props : {children: any, highlight? : boolean})\r\n{\r\n    return (\r\n        <div className={props.highlight ? \"myCard myCardHighlight\" : \"myCard\"}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function InteractionCard(props : {children: any})\r\n{\r\n    return (\r\n        <div className=\"myCard\">\r\n            <div className=\"interactionText\">\r\n                {props.children}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function CardName(props : {card: CardType})\r\n{\r\n    return <span className={\"cardName cardName\" + props.card}>{getCardDetails(props.card).name} ({getCardDetails(props.card).value})</span>;\r\n}\r\n\r\nexport function CardImgAndDetails(props : {card: CardType})\r\n{\r\n    return (\r\n        <React.Fragment>\r\n            <img className=\"cardImg\" src={\"img/\" + props.card.toLowerCase() + \".png\"} alt={props.card}></img>\r\n            <div className=\"cardText\">{getCardDetails(props.card).action}</div>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport function PlayerCharacterName(props : {playerDetails: PlayerDetails})\r\n{\r\n    return (\r\n        <React.Fragment>\r\n            <PlayerCharacter playerDetails={props.playerDetails}/>\r\n            <span className=\"playerName\">{props.playerDetails.name}</span>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport function PlayerCharacter(props : {playerDetails: PlayerDetails})\r\n{\r\n    var imgPath;\r\n    if (props.playerDetails.characterId === -1)\r\n    {\r\n        imgPath = \"img/unknown-character.svg\";\r\n    }\r\n    else if (props.playerDetails.state === \"ALIVE\" || props.playerDetails.state === \"SAFE\")\r\n    {\r\n        imgPath = \"img/characters/\" + charactersMap[props.playerDetails.characterId];\r\n    }\r\n    else // DEAD\r\n    {\r\n        imgPath = \"img/dead-characters/\" + charactersMap[props.playerDetails.characterId];\r\n    }\r\n    return <img className=\"characterImg\" src={imgPath} alt={imgPath}/>;\r\n}\r\n\r\nexport function PlayerState(props : { status : PlayerStatus })\r\n{\r\n    if (props.status === \"SAFE\")\r\n    {\r\n        return <img className=\"statusImg\" src=\"img/shield.svg\" alt=\"SAFE\"/>;\r\n    }\r\n    else if (props.status === \"DEAD\")\r\n    {\r\n        return <img className=\"statusImg\" src=\"img/danger.svg\" alt=\"DEAD\"/>;\r\n    }\r\n    return null;\r\n}\r\n\r\ninterface DotDotDotState {\r\n    \"counter\": number;\r\n}\r\nexport class DotDotDot extends React.Component<{}, DotDotDotState> {\r\n    timerID : NodeJS.Timeout | null;\r\n\r\n    constructor(props : any)\r\n    {\r\n        super(props);\r\n        this.state = {\"counter\": 3};\r\n        this.timerID = null;\r\n    }\r\n\r\n    componentDidMount()\r\n    {\r\n        this.timerID = setInterval(\r\n            () => this.tick(),\r\n            500\r\n        );\r\n    }\r\n\r\n    componentWillUnmount()\r\n    {\r\n        if (this.timerID)\r\n            clearInterval(this.timerID);\r\n    }\r\n\r\n    tick()\r\n    {\r\n        this.setState((state, props) => (\r\n            {\"counter\": (state.counter + 1) % 4}\r\n        ));\r\n    }\r\n\r\n    render()\r\n    {\r\n        var resultStr = \"\";\r\n        var i;\r\n        for (i = -1; i < this.state.counter; i += 1)\r\n        {\r\n            resultStr += \".\";\r\n        }\r\n\r\n        return (\r\n            <span>{resultStr}</span>\r\n        );\r\n    }\r\n}\r\n","import {\n    IonContent,\n    IonIcon,\n    IonItem,\n    IonLabel,\n    IonList,\n    IonMenu,\n} from '@ionic/react';\n\nimport React, { useEffect, useState } from 'react';\nimport { Redirect, useHistory, useLocation } from 'react-router-dom';\nimport { caretForwardCircleOutline, codeOutline, helpCircleOutline, musicalNotesOutline } from 'ionicons/icons';\nimport './Menu.css';\nimport { LVListenerList } from '../UIListeners';\nimport { clientApp } from '../ClientApp';\nimport { PlayerCharacter, PlayerDetails, Volume } from '../Shared';\n\ninterface AppPage {\n    url: string;\n    icon: string;\n    title: string;\n}\n\nconst loginPage = '/page/Login';\n\nconst appPages: AppPage[] = [\n    {\n        title: 'Game',\n        url: '/tabs/game',\n        icon: caretForwardCircleOutline\n    },\n    {\n        title: 'Help',\n        url: '/page/Help',\n        icon: helpCircleOutline\n    }\n];\n\nconst Menu: React.FC = () => {\n    const location = useLocation();\n\n    let history = useHistory();\n    \n    const [loggedIn, setLoggedIn] = useState<boolean>(clientApp.getUiProperty(\"loggedIn\"));\n    const [room, setRoom] = useState<string>(clientApp.getUiProperty(\"roomcode\"));\n    const [playerDetails, setPlayerDetails] = useState<PlayerDetails[]>(clientApp.getUiProperty(\"playerDetails\"));\n    const [playerId, setPlayerId] = useState<number>(clientApp.getUiProperty(\"playerId\"));\n    const [volume, setVolume] = useState<Volume>(clientApp.getUiProperty(\"volume\"));\n\n    useEffect(() => {\n        var listeners = new LVListenerList(\"menu\");\n        listeners.onPropertyChange(\"roomcode\", (value : string) => { setRoom(value); });\n        listeners.onPropertyChange(\"loggedIn\", function (v : boolean) { setLoggedIn(v); });\n        listeners.onPropertyChange(\"playerDetails\", function (v : PlayerDetails[]) { setPlayerDetails(v); });\n        listeners.onPropertyChange(\"playerId\", function (v : number) { setPlayerId(v); });\n        listeners.onPropertyChange(\"volume\", function (v : Volume) { setVolume(v); });\n        listeners.onEvent(\"redirect\", function(v : string) { history.push(v); });\n        return clientApp.effectListeners(listeners);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    if (!loggedIn)\n    {\n        return (\n            <Redirect to={loginPage}></Redirect>\n        );\n    }\n\n    if (location.pathname === loginPage)\n    {\n        return null;\n    }\n\n    function handleAudioClick()\n    {\n        clientApp.toggleVolume();\n    }\n\n    return (\n        <IonMenu contentId=\"main\" type=\"overlay\">\n            <IonContent>\n                <IonList>\n                    {\n                        playerDetails[playerId] === undefined || playerDetails[playerId].characterId === null ? null :\n                        <IonItem lines=\"none\" detail={false}>\n                            <div className=\"menuCharacter\">\n                                <PlayerCharacter playerDetails={playerDetails[playerId]}></PlayerCharacter>\n                            </div>\n                        </IonItem>\n                    }\n                    <IonItem lines=\"none\" detail={false}>\n                        <IonIcon slot=\"start\" icon={codeOutline} />\n                        <IonLabel>Room: {room}</IonLabel>\n                    </IonItem>\n                    { location.pathname === \"/page/PickCharacter\" ? null : appPages.map((appPage, index) => {\n                        return (\n                            <IonItem key={index} className={location.pathname.startsWith(appPage.url) ? 'selected' : ''} routerLink={appPage.url} routerDirection=\"none\" lines=\"none\" detail={false}>\n                                <IonIcon slot=\"start\" icon={appPage.icon} />\n                                <IonLabel>{appPage.title}</IonLabel>\n                            </IonItem>\n                        );\n                    })}\n                    <IonItem lines=\"none\" detail={false} onClick={handleAudioClick}>\n                        <IonIcon slot=\"start\" icon={musicalNotesOutline} />\n                        <IonLabel>Volume: {volume}</IonLabel>\n                    </IonItem>\n                </IonList>\n            </IonContent>\n        </IonMenu>\n    );\n};\n\nexport default Menu;\n","import {\r\n    IonButton,\r\n    IonButtons,\r\n    IonContent, \r\n    IonHeader,\r\n    IonIcon,\r\n    IonMenuButton,\r\n    IonPage,\r\n    IonTitle,\r\n    IonToolbar} from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport Prando from 'prando';\r\nimport { CardType, totalNumberOfCards } from '../cards';\r\nimport { CardName, DotDotDot, LVCard, InteractionCard, PlayerCharacter, PlayerDetails, PlayerState, GameState } from '../Shared';\r\nimport './Page.css';\r\nimport { chevronDownOutline, chevronUpOutline } from 'ionicons/icons';\r\nimport { clientApp } from '../ClientApp';\r\nimport { LVListenerList } from '../UIListeners';\r\n\r\nfunction DiscardList(props : {cards: CardType[]})\r\n{\r\n    return (<>{props.cards.map((card, index) =>\r\n            <div key={index}>\r\n                <CardName card={card} />\r\n            </div>\r\n        )}</>);\r\n}\r\n\r\nexport function Tokens(props : {wins: number, seed: number})\r\n{\r\n    let rng = new Prando(props.seed);\r\n\r\n    interface Gem\r\n    {\r\n        rotate: number;\r\n        hueRotate: number;\r\n        gemId: number;\r\n    }\r\n\r\n    var tokens : Gem[] = [];\r\n    var i : number;\r\n    for (i = 0; i < props.wins; i += 1)\r\n    {\r\n        tokens.push({ \r\n            gemId: rng.nextInt(0, 2),\r\n            hueRotate: rng.nextInt(0, 359),\r\n            rotate: rng.nextInt(0, 359)\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {\r\n                tokens.map((gem, index) =>\r\n                    <img key={index} className=\"gemImg\" style={\r\n                        {\r\n                            \"transform\": \"rotate(\" + gem.rotate + \"deg)\",\r\n                            \"filter\": \"hue-rotate(\" + gem.hueRotate + \"deg)\"\r\n                        } }\r\n                    src={\"img/gem\" + gem.gemId + \".svg\"}\r\n                    alt=\"T\"/>\r\n                )\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\ninterface PlayerLineProps {\r\n    playerDetails: PlayerDetails;\r\n    hasDropdown: boolean;\r\n    seed: number;\r\n}\r\n\r\ninterface PlayerLineState {\r\n    \"dropdownOpen\": boolean;\r\n}\r\nexport class PlayerLine extends React.Component<PlayerLineProps, PlayerLineState> {\r\n    dropdownOpen : boolean;\r\n\r\n    constructor(props : PlayerLineProps)\r\n    {\r\n        super(props);\r\n        this.state = {\"dropdownOpen\": false};\r\n        this.dropdownOpen = false;\r\n    }\r\n\r\n    render()\r\n    {\r\n        var that = this;\r\n        function handleClick()\r\n        {\r\n            if (that.props.hasDropdown)\r\n            {\r\n                that.setState((state, props) => ({\r\n                    dropdownOpen: !state.dropdownOpen\r\n                }));\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div onClick={handleClick} className=\"fullBox\">\r\n                <div className=\"playerTopLine\">\r\n                    <span className=\"playerTopLineLeft\">\r\n                        <PlayerCharacter playerDetails={this.props.playerDetails} />\r\n                        <span className=\"playerName\">{this.props.playerDetails.name}</span>\r\n                        <PlayerState status={this.props.playerDetails.state} />\r\n                    </span>\r\n                    <span className=\"playerTopLineRight\">\r\n                        <span className=\"middlerHack\"></span>\r\n                        <Tokens wins={this.props.playerDetails.wins} seed={this.props.seed} />\r\n                        <span className=\"gemPadding\"></span>\r\n                        {\r\n                            this.props.playerDetails.discarded.length > 0 ?\r\n                                <IonIcon icon={this.state.dropdownOpen ? chevronUpOutline : chevronDownOutline} className=\"verticalAlignMiddle\"></IonIcon>\r\n                                : <span className=\"dropdownHiddenPadding\"></span>\r\n                        }\r\n                    </span>\r\n                </div>\r\n                <div>\r\n                {\r\n                    (this.props.playerDetails.discarded.length === 0 || !this.state.dropdownOpen) ? null :\r\n                    <>\r\n                        <div>Discarded:</div>\r\n                        <DiscardList cards={this.props.playerDetails.discarded} />\r\n                    </>\r\n                }\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nfunction PlayersList(props : {playerDetails : PlayerDetails[], turnId : number, roomSeed : number})\r\n{\r\n    return (<>{props.playerDetails.map((playerDetails, index) =>\r\n        <LVCard key={playerDetails.name} highlight={props.turnId === index}>\r\n            <PlayerLine playerDetails={playerDetails} hasDropdown={playerDetails.discarded.length > 0} seed={props.roomSeed + 10 * index}/>\r\n        </LVCard>\r\n    )}</>);\r\n}\r\n\r\nfunction StartGameCard(props : {playerDetails : PlayerDetails[], gameState: GameState, playerId: number})\r\n{\r\n    function handleStart()\r\n    {\r\n        clientApp.start();\r\n    }\r\n\r\n    if (props.gameState !== \"LOGIN\")\r\n        return null;\r\n\r\n    if (props.playerId === 0)\r\n    {\r\n        var i;\r\n        var allPicked = true;\r\n        for (i = 0; i < props.playerDetails.length; i += 1)\r\n        {\r\n            if (props.playerDetails[i].characterId === -1)\r\n            {\r\n                allPicked = false;\r\n                break;\r\n            }\r\n        }\r\n        if (allPicked)\r\n        {\r\n            if (props.playerDetails.length > 1)\r\n            {\r\n                return (\r\n                    <InteractionCard>\r\n                        <IonButton onClick={handleStart}>Start Game</IonButton>\r\n                    </InteractionCard>\r\n                );\r\n            }\r\n            else\r\n            {\r\n                return (\r\n                    <InteractionCard>\r\n                        <div className=\"interactionText\">\r\n                            Waiting for more players\r\n                        </div>\r\n                        <div className=\"interactionDots\">\r\n                            <DotDotDot />\r\n                        </div>\r\n                    </InteractionCard>\r\n                );\r\n            }\r\n        }\r\n        else\r\n        {\r\n            return (\r\n                <InteractionCard>\r\n                    <div className=\"interactionText\">\r\n                        Waiting players to pick character\r\n                    </div>\r\n                    <div className=\"interactionDots\">\r\n                        <DotDotDot />\r\n                    </div>\r\n                </InteractionCard>\r\n            );\r\n        }\r\n    }\r\n    else\r\n    {\r\n        return (\r\n            <InteractionCard>\r\n                <div className=\"interactionText\">\r\n                    Waiting for game to start\r\n                </div>\r\n                <div className=\"interactionDots\">\r\n                    <DotDotDot />\r\n                </div>\r\n            </InteractionCard>\r\n        );\r\n    }\r\n}\r\n\r\nfunction TopLine(props : {discardedCardTotals : number[], playerDetails: PlayerDetails[], gameState: GameState, roomCode: string})\r\n{\r\n    if (props.gameState === \"LOGIN\")\r\n    {\r\n        return (\r\n            <InteractionCard>Room code {props.roomCode}</InteractionCard>\r\n        );\r\n    }\r\n\r\n    var i;\r\n    var totalDiscards = 0;\r\n    for (i = 0; i < props.discardedCardTotals.length; i += 1)\r\n    {\r\n        totalDiscards += props.discardedCardTotals[i];\r\n    }\r\n    // -1 for hidden card, -1 for active player having 2 cards\r\n    var cardsLeft = totalNumberOfCards - 2 - totalDiscards;\r\n    for (i = 0; i < props.playerDetails.length; i += 1)\r\n    {\r\n        if (props.playerDetails[i].state !== \"DEAD\")\r\n        {\r\n            cardsLeft -= 1;\r\n        }\r\n    }\r\n\r\n    if (cardsLeft <= 0)\r\n    {\r\n        return (\r\n            <LVCard>\r\n                <div className=\"cardsLeft\">\r\n                    Last turn!\r\n                </div>\r\n            </LVCard>\r\n        );\r\n    }\r\n    else if (cardsLeft < 5)\r\n    {\r\n        return (\r\n            <LVCard>\r\n                <div className=\"cardsLeft\">\r\n                    {cardsLeft} cards left{cardsLeft <= 2 ? \"!\" : \"...\"}\r\n                </div>\r\n            </LVCard>\r\n        );\r\n    }\r\n    else\r\n    {\r\n        return null;\r\n    }\r\n}\r\n\r\nconst GamePage: React.FC = () => {\r\n\r\n    const [playerDetails, setPlayerDetails] = useState<PlayerDetails[]>(clientApp.getUiProperty(\"playerDetails\"));\r\n    const [discardedCardTotals, setDiscardedCardTotals] = useState<number[]>(clientApp.getUiProperty(\"discardedCardTotals\"));\r\n    const [gameState, setGameState] = useState<GameState>(clientApp.getUiProperty(\"gameState\"));\r\n    const [roomSeed, setRoomSeed] = useState<number>(clientApp.getUiProperty(\"roomSeed\"));\r\n    const [room, setRoom] = useState<string>(clientApp.getUiProperty(\"roomcode\"));\r\n    const [playerId, setPlayerId] = useState<number>(clientApp.getUiProperty(\"playerId\"));\r\n    const [turnId, setTurnId] = useState<number>(clientApp.getUiProperty(\"turnId\"));\r\n    \r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"game\");\r\n        listeners.onPropertyChange(\"roomcode\", (value : string) => { setRoom(value); });\r\n        listeners.onPropertyChange(\"playerDetails\", function(value : PlayerDetails[]) { setPlayerDetails(value); });\r\n        listeners.onPropertyChange(\"discardedCardTotals\", function(value : number[]) { setDiscardedCardTotals(value); });\r\n        listeners.onPropertyChange(\"gameState\", function(value : GameState) { setGameState(value); });\r\n        listeners.onPropertyChange(\"roomSeed\", function(value : number) { setRoomSeed(value); });\r\n        listeners.onPropertyChange(\"playerId\", function(value : number) { setPlayerId(value); });\r\n        listeners.onPropertyChange(\"turnId\", function(value : number) { setTurnId(value); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    return (\r\n    <IonPage id=\"game\">\r\n        <IonContent fullscreen>\r\n            <IonHeader>\r\n                <IonToolbar>\r\n                    <IonButtons slot=\"start\">\r\n                        <IonMenuButton />\r\n                    </IonButtons>\r\n                    <IonTitle></IonTitle>\r\n                </IonToolbar>\r\n            </IonHeader>\r\n            <TopLine discardedCardTotals={discardedCardTotals} playerDetails={playerDetails} gameState={gameState} roomCode={room} />\r\n            <PlayersList playerDetails={playerDetails} turnId={turnId} roomSeed={roomSeed} />\r\n            <StartGameCard playerDetails={playerDetails} gameState={gameState} playerId={playerId} />\r\n        </IonContent>\r\n    </IonPage>\r\n    );\r\n};\r\n\r\nexport default GamePage;","import {\r\n    IonButton,\r\n    IonButtons,\r\n    IonContent, \r\n    IonHeader,\r\n    IonItem,\r\n    IonList,\r\n    IonMenuButton,\r\n    IonPage,\r\n    IonTitle,\r\n    IonToolbar} from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { CardType, getCardDetails, orderedCards } from '../cards';\r\nimport { CardImgAndDetails, CardName, LVCard, PlayerCharacter, PlayerCharacterName, PlayerDetails, PlayerState } from '../Shared';\r\nimport './Page.css';\r\nimport { clientApp } from '../ClientApp';\r\nimport { LVListenerList } from '../UIListeners';\r\n\r\nfunction PlayCard(props : {playerDetails : PlayerDetails[], playerId : number, handId: number, card : CardType, otherCard : CardType, discardedCardTotals: number[]})\r\n{\r\n    type PlayCardState = \"\" | \"PICK_TARGET\" | \"PICK_GUESS\";\r\n\r\n    const [playState, setPlayState] = useState<PlayCardState>(\"\");\r\n    const [pickedTarget, setPickedTarget] = useState<number>(-1);\r\n    const [waiting, setWaiting] = useState<boolean>(false);\r\n\r\n    function handlePlayCardClick()\r\n    {\r\n        var card = props.card;\r\n        if (card === \"GUARD\" ||\r\n            card === \"PRIEST\" ||\r\n            card === \"BARON\" ||\r\n            card === \"PRINCE\" ||\r\n            card === \"KING\")\r\n        {\r\n            setPlayState(\"PICK_TARGET\");\r\n        }\r\n        else\r\n        {\r\n            clientApp.playCard(props.handId);\r\n            setWaiting(true);\r\n        }\r\n    }\r\n\r\n    function handlePickTargetClick(targetId : number)\r\n    {\r\n        var card = props.card;\r\n        if (card === \"GUARD\")\r\n        {\r\n            setPickedTarget(targetId);\r\n            setPlayState(\"PICK_GUESS\");\r\n        }\r\n        else\r\n        {\r\n            clientApp.playCard(props.handId, targetId);\r\n            setWaiting(true);\r\n        }\r\n    }\r\n\r\n    function handleNoValidTargetClick()\r\n    {\r\n        clientApp.playCard(props.handId, -1);\r\n        setWaiting(true);\r\n    }\r\n\r\n    function handlePickGuessClick(guessCardType : CardType)\r\n    {\r\n        clientApp.playCard(props.handId, pickedTarget, guessCardType);\r\n        setWaiting(true);\r\n    }\r\n\r\n    function handleBackClick()\r\n    {\r\n        if (playState === \"PICK_GUESS\")\r\n        {\r\n            setPlayState(\"PICK_TARGET\");\r\n        }\r\n        else if (playState === \"PICK_TARGET\")\r\n        {\r\n            setPlayState(\"\");\r\n        }\r\n    }\r\n\r\n    if (playState === \"\")\r\n    {\r\n        if (props.otherCard === \"COUNTESS\" && (props.card === \"KING\" || props.card === \"PRINCE\"))\r\n        {\r\n            return (\r\n                <LVCard>\r\n                    <div className=\"cardPlayButtonDiv\">\r\n                        Must play <CardName card={\"COUNTESS\"} />\r\n                    </div>\r\n                </LVCard>\r\n            );\r\n        }\r\n        else\r\n        {\r\n            return (\r\n                <LVCard>\r\n                    <div className=\"cardPlayButtonDiv\">\r\n                        <IonButton onClick={handlePlayCardClick} disabled={waiting}>Play</IonButton>\r\n                    </div>\r\n                </LVCard>\r\n            );\r\n        }\r\n    }\r\n    else if (playState === \"PICK_TARGET\")\r\n    {\r\n        var anyValidTargets = false;\r\n        var targetList = props.playerDetails.map(function(playerDetails, index)\r\n            {\r\n                if (props.playerId === index && props.card !== \"PRINCE\")\r\n                    return null;\r\n\r\n                anyValidTargets = anyValidTargets || playerDetails.state === \"ALIVE\";\r\n                return (\r\n                    <IonItem key={playerDetails.name}>\r\n                        <div className=\"fullBox\">\r\n                            <div className=\"playerTopLine\">\r\n                                <span className=\"playerTopLineLeft\">\r\n                                    <PlayerCharacter playerDetails={playerDetails} />\r\n                                    <span className=\"playerName\">{playerDetails.name}</span>\r\n                                    <PlayerState status={playerDetails.state} />\r\n                                </span>\r\n                                {\r\n                                    playerDetails.state !== \"ALIVE\" ? null :\r\n                                        <span className=\"playerTopLineRight\">\r\n                                            <IonButton className=\"verticalAlignMiddle\" onClick={(e) => handlePickTargetClick(index)} disabled={waiting}>PICK</IonButton>\r\n                                        </span>\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </IonItem>\r\n                );\r\n            }\r\n        );\r\n\r\n        return (\r\n            <React.Fragment>\r\n                <LVCard>\r\n                    <div className=\"interactionText\">\r\n                        Pick a target\r\n                    </div>\r\n                </LVCard>\r\n                <LVCard>\r\n                    <IonList>\r\n                        {targetList}\r\n                        {anyValidTargets ? null :\r\n                            <IonItem>\r\n                                <div className=\"center\">\r\n                                    <IonButton onClick={handleNoValidTargetClick} disabled={waiting}>No valid target</IonButton>\r\n                                </div>\r\n                            </IonItem>\r\n                        }\r\n                    </IonList>\r\n                    <div className=\"cardPlayButtonDiv\">\r\n                        <IonButton onClick={handleBackClick}>Back</IonButton>\r\n                    </div>\r\n                </LVCard>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n    else if (playState === \"PICK_GUESS\")\r\n    {\r\n        var targetPlayerDetails = props.playerDetails[pickedTarget];\r\n        return (\r\n            <React.Fragment>\r\n                <LVCard>\r\n                    <div className=\"interactionText\">\r\n                        Guess what card <PlayerCharacterName playerDetails={targetPlayerDetails} /> has\r\n                    </div>\r\n                </LVCard>\r\n                <LVCard>\r\n                    <IonList>\r\n                        <IonItem>\r\n                            <div className=\"fullBox\">\r\n                                <div className=\"cardOptionLine\">\r\n                                    <span className=\"cardOptionRight\">\r\n                                        (# Played / # In Deck)\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </IonItem>\r\n                        {\r\n\r\n                            orderedCards.map((cardType : CardType, index) =>\r\n                                (cardType === \"GUARD\") ? null :\r\n                                <IonItem key={index}>\r\n                                    <div className=\"fullBox\">\r\n                                        <div className=\"cardOptionLine\">\r\n                                            <span className=\"cardOptionLeft\">\r\n                                                <CardName card={cardType} />\r\n                                            </span>\r\n                                            <span className=\"cardOptionRight\">\r\n                                                <IonButton disabled={waiting} className=\"verticalAlignMiddle\" onClick={(e) => handlePickGuessClick(cardType)}>\r\n                                                    Pick ({props.discardedCardTotals[index]} / {getCardDetails(cardType).numInDeck})\r\n                                                </IonButton>\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </IonItem>\r\n                            )\r\n                        }\r\n                        <div className=\"cardPlayButtonDiv\">\r\n                            <IonButton onClick={handleBackClick}>Back</IonButton>\r\n                        </div>\r\n                    </IonList>\r\n                </LVCard>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction CardPage(props: {handId: number})\r\n{\r\n    const [hand, setHand] = useState<CardType[]>(clientApp.getUiProperty(\"hand\"));\r\n    const [playerDetails, setPlayerDetails] = useState<PlayerDetails[]>(clientApp.getUiProperty(\"playerDetails\"));\r\n    const [playerId, setPlayerId] = useState<number>(clientApp.getUiProperty(\"playerId\"));\r\n    const [turnId, setTurnId] = useState<number>(clientApp.getUiProperty(\"turnId\"));\r\n    const [discardedCardTotals, setDiscardedCardTotals] = useState<number[]>(clientApp.getUiProperty(\"discardedCardTotals\"));\r\n\r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"card\");\r\n        listeners.onPropertyChange(\"hand\", function(value : CardType[]) { setHand(value); });\r\n        listeners.onPropertyChange(\"playerDetails\", function(value : PlayerDetails[]) { setPlayerDetails(value); });\r\n        listeners.onPropertyChange(\"discardedCardTotals\", function(value : number[]) { setDiscardedCardTotals(value); });\r\n        listeners.onPropertyChange(\"playerId\", function(value : number) { setPlayerId(value); });\r\n        listeners.onPropertyChange(\"turnId\", function(value : number) { setTurnId(value); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    var handId = props.handId;\r\n\r\n    var content;\r\n    var title;\r\n    if (handId >= hand.length)\r\n    {\r\n        title = <>No card</>;\r\n        content = null;\r\n    }\r\n    else\r\n    {\r\n        title = <CardName card={hand[handId]}></CardName>;\r\n        content = (\r\n        <>\r\n            <LVCard>\r\n            <CardImgAndDetails card={hand[handId]}/>\r\n            </LVCard>\r\n            {\r\n                turnId !== playerId ? null :\r\n                <PlayCard playerDetails={playerDetails} playerId={playerId} handId={handId} card={hand[handId]} otherCard={hand[handId === 0 ? 1 : 0]} discardedCardTotals={discardedCardTotals}></PlayCard>\r\n            }\r\n        </>);\r\n    }\r\n\r\n    return (\r\n    <IonPage>\r\n        <IonContent fullscreen>\r\n            <IonHeader>\r\n                <IonToolbar>\r\n                    <IonButtons slot=\"start\">\r\n                        <IonMenuButton />\r\n                    </IonButtons>\r\n                    <IonTitle>{title}</IonTitle>\r\n                </IonToolbar>\r\n            </IonHeader>\r\n            {content}\r\n        </IonContent>\r\n    </IonPage>\r\n    );\r\n};\r\n\r\nexport default CardPage;","import { IonButton, IonButtons, IonContent, IonHeader, IonMenuButton, IonPage, IonTitle, IonToolbar } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { CardType } from '../cards';\r\nimport { clientApp } from '../ClientApp';\r\nimport { CardImgAndDetails, CardName, DotDotDot, Interaction, InteractionCard, LVCard, PlayerCharacterName, PlayerDetails, PlayerState } from '../Shared';\r\nimport { LVListenerList } from '../UIListeners';\r\nimport './Page.css';\r\n\r\nfunction PlayerDiscard(props : { playerDetails : PlayerDetails, card : CardType })\r\n{\r\n    return (\r\n        <React.Fragment>\r\n            <InteractionCard>\r\n                <PlayerCharacterName playerDetails={props.playerDetails} /> discarded\r\n            </InteractionCard>\r\n            <LVCard>\r\n                <CardImgAndDetails card={props.card} />\r\n            </LVCard>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nfunction PlayerEliminated(props : { playerDetails : PlayerDetails })\r\n{\r\n    return (\r\n        <InteractionCard>\r\n            <PlayerCharacterName playerDetails={props.playerDetails} /> has been eliminated!\r\n            <PlayerState status=\"DEAD\" />\r\n        </InteractionCard>\r\n    );\r\n}\r\n\r\nfunction SecretReveal(props : { playerDetails : PlayerDetails, card : CardType })\r\n{\r\n    return (\r\n        <React.Fragment>\r\n            <InteractionCard>\r\n                <PlayerCharacterName playerDetails={props.playerDetails} /> secretly reveals\r\n            </InteractionCard>\r\n            <LVCard>\r\n                <CardImgAndDetails card={props.card} />\r\n            </LVCard>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nfunction InteractionContent()\r\n{\r\n    const [playerDetails, setPlayerDetails] = useState<PlayerDetails[]>(clientApp.getUiProperty(\"playerDetails\"));\r\n    const [playerId, setPlayerId] = useState<number>(clientApp.getUiProperty(\"playerId\"));\r\n    const [turnId, setTurnId] = useState<number>(clientApp.getUiProperty(\"turnId\"));\r\n    const [interaction, setInteraction] = useState<Interaction>(clientApp.getUiProperty(\"interaction\"));\r\n\r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"interaction\");\r\n        listeners.onPropertyChange(\"playerDetails\", function(value : PlayerDetails[]) { setPlayerDetails(value); });\r\n        listeners.onPropertyChange(\"playerId\", function(value : number) { setPlayerId(value); });\r\n        listeners.onPropertyChange(\"turnId\", function(value : number) { setTurnId(value); });\r\n        listeners.onPropertyChange(\"interaction\", function(value : Interaction) { setInteraction(value); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    if (interaction.status !== \"REVEAL\" && interaction.status !== \"CONTINUE\")\r\n    {\r\n        if (playerDetails !== undefined && turnId !== undefined && turnId >= 0 && turnId < playerDetails.length)\r\n        {\r\n            return <InteractionCard>Waiting for <PlayerCharacterName playerDetails={playerDetails[turnId]!} /></InteractionCard>;\r\n        }\r\n        else\r\n        {\r\n            return <InteractionCard>Waiting for something to happen...</InteractionCard>;\r\n        }\r\n    }\r\n\r\n    var turnPlayerDetails = playerDetails[interaction.playerId];\r\n    var targetPlayerDetails : PlayerDetails | null = null;\r\n    var hasTarget : boolean = interaction.targetId !== undefined && interaction.targetId !== -1;\r\n    if (hasTarget)\r\n    {\r\n        targetPlayerDetails = playerDetails[interaction.targetId!];\r\n    }\r\n\r\n    function handleEndTurn()\r\n    {\r\n        clientApp.interactionStep();\r\n    }\r\n\r\n    function handleReveal()\r\n    {\r\n        clientApp.interactionStep();\r\n    }\r\n\r\n    var interactionBlock;\r\n    var waitingText = '';\r\n\r\n    if (interaction.playedCard === \"GUARD\")\r\n    {\r\n        if (hasTarget)\r\n        {\r\n            interactionBlock = (\r\n                <InteractionCard>\r\n                    To target <PlayerCharacterName playerDetails={targetPlayerDetails!} />\r\n                    and guessed<span className=\"hspacer\"></span><CardName card={interaction.guess!} />\r\n                </InteractionCard>\r\n            );\r\n            waitingText = \"Waiting for the big reveal\";\r\n        }\r\n        else\r\n        {\r\n            interactionBlock = (\r\n                <InteractionCard>\r\n                    But there is nobody to target\r\n                </InteractionCard>\r\n            );\r\n        }\r\n    }\r\n    else if (interaction.playedCard === \"PRIEST\" ||\r\n             interaction.playedCard === \"BARON\" ||\r\n             interaction.playedCard === \"PRINCE\" ||\r\n             interaction.playedCard === \"KING\")\r\n    {\r\n        if (hasTarget)\r\n        {\r\n            interactionBlock = (\r\n                <InteractionCard>\r\n                    To target <PlayerCharacterName playerDetails={targetPlayerDetails!} />\r\n                </InteractionCard>\r\n            );\r\n            waitingText = \"Waiting for the big reveal\";\r\n        }\r\n        else\r\n        {\r\n            interactionBlock = (\r\n                <InteractionCard>\r\n                    But there is nobody to target\r\n                </InteractionCard>\r\n            );\r\n        }\r\n    }\r\n    else if (interaction.playedCard === \"PRINCESS\")\r\n    {\r\n        interactionBlock = (\r\n            <PlayerEliminated playerDetails={turnPlayerDetails} />\r\n        );\r\n    }\r\n\r\n    var endTurn = null;\r\n    var otherDetails = null;\r\n    if (interaction.status === \"REVEAL\" && interaction.targetId === playerId)\r\n    {\r\n        // TODO these states!\r\n        otherDetails = (\r\n            <InteractionCard>\r\n                <IonButton onClick={handleReveal}>Reveal</IonButton>\r\n            </InteractionCard>\r\n        );\r\n    }\r\n    else if (interaction.status === \"CONTINUE\")\r\n    {\r\n        if (interaction.playerId === playerId)\r\n        {\r\n            endTurn = (\r\n                <InteractionCard>\r\n                    <IonButton onClick={handleEndTurn}>End Turn</IonButton>\r\n                </InteractionCard>\r\n            );\r\n        }\r\n        else\r\n        {\r\n            endTurn = (\r\n                <LVCard>\r\n                    <div className=\"interactionText\">\r\n                        Waiting for turn to end\r\n                    </div>\r\n                    <div className=\"interactionDots\">\r\n                        <DotDotDot />\r\n                    </div>\r\n                </LVCard>\r\n            );\r\n        }\r\n\r\n        if (interaction.playedCard === \"GUARD\" && hasTarget)\r\n        {\r\n            if (interaction.result === \"CORRECT_GUESS\")\r\n            {\r\n                otherDetails = (\r\n                    <React.Fragment>\r\n                        <PlayerDiscard playerDetails={targetPlayerDetails!} card={interaction.guess!} />\r\n                        <PlayerEliminated playerDetails={targetPlayerDetails!} />\r\n                    </React.Fragment>\r\n                );\r\n            }\r\n            else\r\n            {\r\n                otherDetails = (\r\n                    <InteractionCard>\r\n                        The guess was incorrect\r\n                    </InteractionCard>\r\n                );\r\n            }\r\n        }\r\n        else if (interaction.playedCard === \"PRIEST\" && hasTarget)\r\n        {\r\n            if (interaction.playerId === playerId || interaction.targetId === playerId)\r\n            {\r\n                otherDetails = (\r\n                    <React.Fragment>\r\n                        <SecretReveal playerDetails={targetPlayerDetails!} card={interaction.revealedCard!} />\r\n                    </React.Fragment>\r\n                );\r\n            }\r\n            else\r\n            {\r\n                otherDetails = (\r\n                    <React.Fragment>\r\n                        <InteractionCard>\r\n                            <PlayerCharacterName playerDetails={targetPlayerDetails!} /> has secretly revealed their card\r\n                        </InteractionCard>\r\n                    </React.Fragment>\r\n                );\r\n            }\r\n        }\r\n        else if (interaction.playedCard === \"BARON\" && hasTarget)\r\n        {\r\n            var winner : number = interaction.loserId === interaction.playerId ? interaction.targetId! : interaction.playerId;\r\n            var winnerPlayerDetails = playerDetails[winner];\r\n            var loserPlayerDetails = playerDetails[interaction.loserId!];\r\n\r\n            if (interaction.playerId === playerId || interaction.targetId === playerId)\r\n            {\r\n                if (interaction.result === \"TIE\")\r\n                {\r\n                    otherDetails = (\r\n                        <React.Fragment>\r\n                            <SecretReveal playerDetails={turnPlayerDetails} card={interaction.revealedCard!} />\r\n                            <SecretReveal playerDetails={targetPlayerDetails!} card={interaction.revealedCard!} />\r\n                            <InteractionCard>\r\n                                Its a tie! (nothing happens)\r\n                            </InteractionCard>\r\n                        </React.Fragment>\r\n                    );\r\n                }\r\n                else\r\n                {\r\n                    var baronTurnPlayerCard : CardType = playerId === interaction.playerId ? interaction.otherCard! : interaction.revealedCard!;\r\n                    var baronTargetPlayerCard : CardType = playerId === interaction.targetId ? interaction.otherCard! : interaction.revealedCard!;\r\n                    otherDetails = (\r\n                        <React.Fragment>\r\n                            <SecretReveal playerDetails={turnPlayerDetails} card={baronTurnPlayerCard} />\r\n                            <SecretReveal playerDetails={targetPlayerDetails!} card={baronTargetPlayerCard} />\r\n                            <InteractionCard>\r\n                                <PlayerCharacterName playerDetails={winnerPlayerDetails} /> wins!\r\n                            </InteractionCard>\r\n                            <PlayerEliminated playerDetails={loserPlayerDetails} />\r\n                        </React.Fragment>\r\n                    );\r\n                }\r\n            }\r\n            else\r\n            {\r\n                if (interaction.result === \"TIE\")\r\n                {\r\n                    otherDetails = (\r\n                        <InteractionCard>\r\n                            Its a tie! (nothing happens)\r\n                        </InteractionCard>\r\n                    );\r\n                }\r\n                else\r\n                {\r\n                    otherDetails = (\r\n                        <React.Fragment>\r\n                            <InteractionCard>\r\n                                <PlayerCharacterName playerDetails={winnerPlayerDetails} /> wins!\r\n                            </InteractionCard>\r\n                            <PlayerDiscard playerDetails={loserPlayerDetails} card={interaction.discard!} />\r\n                            <PlayerEliminated playerDetails={loserPlayerDetails} />\r\n                        </React.Fragment>\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        else if (interaction.playedCard === \"PRINCE\" && hasTarget)\r\n        {\r\n            otherDetails = (\r\n                <React.Fragment>\r\n                    <PlayerDiscard playerDetails={targetPlayerDetails!} card={interaction.revealedCard!} />\r\n                    {\r\n                        interaction.revealedCard !== \"PRINCESS\" ? null :\r\n                        <PlayerEliminated playerDetails={targetPlayerDetails!} />\r\n                    }\r\n                </React.Fragment>\r\n            );\r\n        }\r\n        else if (interaction.playedCard === \"KING\" && hasTarget)\r\n        {\r\n            if (interaction.playerId === playerId || interaction.targetId === playerId)\r\n            {\r\n                var kingTurnPlayerCard : CardType = playerId === interaction.playerId ? interaction.otherCard! : interaction.swappedFor!;\r\n                var kingTargetPlayerCard : CardType = playerId === interaction.targetId ? interaction.prevCard! : interaction.swappedFor!;\r\n                otherDetails = (\r\n                    <React.Fragment>\r\n                        <SecretReveal playerDetails={turnPlayerDetails} card={kingTurnPlayerCard} />\r\n                        <SecretReveal playerDetails={targetPlayerDetails!} card={kingTargetPlayerCard} />\r\n                        <InteractionCard>\r\n                            <PlayerCharacterName playerDetails={turnPlayerDetails} /> now has <span className=\"hspacer\"></span><CardName card={kingTargetPlayerCard}/>\r\n                        </InteractionCard>\r\n                        <InteractionCard>\r\n                            <PlayerCharacterName playerDetails={targetPlayerDetails!} /> now has <span className=\"hspacer\"></span><CardName card={kingTurnPlayerCard}/>\r\n                        </InteractionCard>\r\n                    </React.Fragment>\r\n                );\r\n            }\r\n        }\r\n    }\r\n    else\r\n    {\r\n        otherDetails = (\r\n            <LVCard>\r\n                <div className=\"interactionText\">\r\n                    {waitingText}\r\n                </div>\r\n                <div className=\"interactionDots\">\r\n                    <DotDotDot />\r\n                </div>\r\n            </LVCard>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <LVCard>\r\n                <div className=\"interactionText\">\r\n                    <PlayerCharacterName playerDetails={turnPlayerDetails} /> played\r\n                </div>\r\n            </LVCard>\r\n\r\n            <LVCard>\r\n                <CardImgAndDetails card={interaction.playedCard} />\r\n            </LVCard>\r\n\r\n            {interactionBlock}\r\n            {otherDetails}\r\n            {endTurn}\r\n\r\n            <div className=\"scrollHack\"></div>\r\n        </>\r\n    );\r\n}\r\n\r\n\r\nconst InteractionPage: React.FC = () => {\r\n    return (\r\n        <IonPage>\r\n            <IonContent fullscreen>\r\n                <IonHeader>\r\n                    <IonToolbar>\r\n                        <IonButtons slot=\"start\">\r\n                            <IonMenuButton />\r\n                        </IonButtons>\r\n                        <IonTitle>Action</IonTitle>\r\n                    </IonToolbar>\r\n                </IonHeader>\r\n                <InteractionContent />\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n}\r\n\r\nexport default InteractionPage;","import {\r\n    IonIcon,\r\n    IonLabel,\r\n    IonRouterOutlet,\r\n    IonTabBar,\r\n    IonTabButton,\r\n    IonTabs} from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Redirect, Route } from 'react-router';\r\nimport './Page.css';\r\nimport { caretForwardCircleOutline, accessibilityOutline, tabletPortraitOutline } from 'ionicons/icons';\r\nimport GamePage from './GamePage';\r\nimport CardPage from './CardPage';\r\nimport { CardName, PlayerDetails, PlayerState } from '../Shared';\r\nimport { CardType } from '../cards';\r\nimport { clientApp } from '../ClientApp';\r\nimport { LVListenerList } from '../UIListeners';\r\nimport InteractionPage from './InteractionPage';\r\n\r\nconst GameTabPage: React.FC = () => {\r\n\r\n    const [hand, setHand] = useState<CardType[]>(clientApp.getUiProperty(\"hand\"));\r\n    const [playerDetails, setPlayerDetails] = useState<PlayerDetails[]>(clientApp.getUiProperty(\"playerDetails\"));\r\n    const [playerId, setPlayerId] = useState<number>(clientApp.getUiProperty(\"playerId\"));\r\n    \r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"game\");\r\n        listeners.onPropertyChange(\"hand\", function(value) { setHand(value); });\r\n        listeners.onPropertyChange(\"playerDetails\", function(value : PlayerDetails[]) { setPlayerDetails(value); });\r\n        listeners.onPropertyChange(\"playerId\", function(value : number) { setPlayerId(value); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    var cardIcon = <IonIcon icon={tabletPortraitOutline} />;\r\n    var isDead = false;\r\n    if (playerDetails && playerId !== undefined && playerId >= 0 && playerId < playerDetails.length)\r\n    {\r\n        if (playerDetails[playerId].state === \"DEAD\")\r\n        {\r\n            cardIcon = <PlayerState status=\"DEAD\"></PlayerState>;\r\n            isDead = true;\r\n        }\r\n    }\r\n\r\n    return (\r\n    <IonTabs>\r\n        <IonRouterOutlet>\r\n            <Redirect exact path=\"/tabs\" to=\"/tabs/game\" />\r\n            <Redirect exact path=\"/\" to=\"/tabs/game\" />\r\n            <Route path=\"/tabs/game\" render={() => <GamePage />} exact />\r\n            <Route path=\"/tabs/card/0\" render={() => <CardPage handId={0} />} exact />\r\n            <Route path=\"/tabs/card/1\" render={() => <CardPage handId={1} />} exact />\r\n            <Route path=\"/tabs/interaction\" render={() => <InteractionPage />} exact />\r\n        </IonRouterOutlet>\r\n        <IonTabBar slot=\"bottom\">\r\n            <IonTabButton tab=\"interaction\" href=\"/tabs/interaction\">\r\n                <IonIcon icon={caretForwardCircleOutline} />\r\n                <IonLabel>Action</IonLabel>\r\n            </IonTabButton>\r\n            <IonTabButton tab=\"game\" href=\"/tabs/game\">\r\n                <IonIcon icon={accessibilityOutline} />\r\n                <IonLabel>Players</IonLabel>\r\n            </IonTabButton>\r\n            {\r\n                <IonTabButton tab=\"card0\" href=\"/tabs/card/0\" disabled={isDead}>\r\n                    {cardIcon}\r\n                    {\r\n                        isDead ? \"DEAD\" : (\r\n                            hand.length === 0 ? \"None\" :\r\n                            <CardName card={hand[0]}></CardName>)\r\n                    }\r\n                </IonTabButton>\r\n            }\r\n            {\r\n                hand.length <= 1 ? \"None\" :\r\n                <IonTabButton tab=\"card1\" href=\"/tabs/card/1\">\r\n                    <IonIcon icon={tabletPortraitOutline} />\r\n                    <CardName card={hand[1]}></CardName>\r\n                </IonTabButton>\r\n            }\r\n        </IonTabBar>\r\n    </IonTabs>\r\n    );\r\n};\r\n\r\nexport default GameTabPage;\r\n","import {\r\n    IonButtons, \r\n    IonContent, \r\n    IonHeader,\r\n    IonMenuButton,\r\n    IonPage,\r\n    IonTitle,\r\n    IonToolbar,\r\n    IonSlides,\r\n    IonSlide,\r\n    IonButton} from '@ionic/react';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { getCardDetails, orderedCards } from '../cards';\r\nimport './Page.css';\r\nimport { CardImgAndDetails, CardName, DiscardedCardTotals, LVCard } from '../Shared'\r\nimport { clientApp } from '../ClientApp';\r\nimport { LVListenerList } from '../UIListeners';\r\n\r\ntype GotoSlideCb = (index : number) => void;\r\n\r\nfunction QuickHelpList(props : {discardedCardTotals: DiscardedCardTotals, gotoSlideCb : GotoSlideCb})\r\n{\r\n    function handleClick(index : number)\r\n    {\r\n        props.gotoSlideCb(index + 1);\r\n    }\r\n\r\n    return <>{\r\n        orderedCards.map((cardType, index) =>\r\n        <div key={cardType} onClick={() => handleClick(index)}>\r\n            <span className=\"alignLeft\"><CardName card={cardType} /></span>\r\n            <span className=\"alignRight\">{props.discardedCardTotals[index]} / {getCardDetails(cardType).numInDeck}</span>\r\n            <br />\r\n            <br />\r\n        </div>\r\n    )}</>;\r\n}\r\n\r\nfunction QuickHelpCard(props : {discardedCardTotals: DiscardedCardTotals, gotoSlideCb : GotoSlideCb})\r\n{\r\n    return (\r\n        <LVCard>\r\n            <span className=\"alignLeft\">Card (value)</span>\r\n            <span className=\"alignRight\"># Discarded / # In Deck</span><br/><br/>\r\n            <QuickHelpList discardedCardTotals={props.discardedCardTotals} gotoSlideCb={props.gotoSlideCb} />\r\n        </LVCard>\r\n    );\r\n}\r\n\r\nfunction HelpCardItems(props : {gotoSlideCb : GotoSlideCb})\r\n{\r\n    function handleClick()\r\n    {\r\n        props.gotoSlideCb(0);\r\n    }\r\n\r\n    return (<>{orderedCards.map((cardType, index) =>\r\n        <IonSlide key={cardType}>\r\n            <LVCard>\r\n                <CardImgAndDetails card={cardType} />\r\n                <IonButton onClick={handleClick}>Back</IonButton>\r\n            </LVCard>\r\n        </IonSlide>\r\n    )}</>)\r\n}\r\n\r\nconst HelpPage: React.FC = () => {\r\n    \r\n    const [discardedCardTotals, setDiscardedCardTotals] = useState<number[]>(clientApp.getUiProperty(\"discardedCardTotals\"));\r\n    \r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"help\");\r\n        listeners.onPropertyChange(\"discardedCardTotals\", function(value : number[]) { setDiscardedCardTotals(value); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    const slidesRef = useRef<HTMLIonSlidesElement>(null);\r\n\r\n    const handleGotoSlideCb = function (index : number)\r\n    {\r\n        slidesRef.current?.slideTo(index);\r\n    }\r\n\r\n    return (\r\n    <IonPage>\r\n        <IonHeader>\r\n            <IonToolbar>\r\n                <IonButtons slot=\"start\">\r\n                    <IonMenuButton />\r\n                </IonButtons>\r\n                <IonTitle>Help</IonTitle>\r\n            </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent fullscreen>\r\n        <IonSlides ref={slidesRef}>\r\n            <IonSlide>\r\n                <QuickHelpCard discardedCardTotals={discardedCardTotals} gotoSlideCb={handleGotoSlideCb} />\r\n            </IonSlide>\r\n            <HelpCardItems gotoSlideCb={handleGotoSlideCb}/>\r\n        </IonSlides>\r\n        </IonContent>\r\n    </IonPage>\r\n    );\r\n};\r\n\r\nexport default HelpPage;\r\n","import React, { useState } from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonInput, IonItem, IonLabel, IonList, IonItemDivider } from '@ionic/react';\n\nexport const InputExamples: React.FC = () => {\n\n  const [text, setText] = useState<string>();\n  const [number, setNumber] = useState<number>();\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>IonInput Examples</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonList>\n          <IonItemDivider>Default Input with Placeholder</IonItemDivider>\n          <IonItem>\n            <IonInput value={text} placeholder=\"Enter Input\" onIonChange={e => setText(e.detail.value!)}></IonInput>\n          </IonItem>\n\n          <IonItemDivider>Input with clear button when there is a value</IonItemDivider>\n          <IonItem>\n            <IonInput value={text} placeholder=\"Enter Input\" onIonChange={e => setText(e.detail.value!)} clearInput></IonInput>\n          </IonItem>\n\n          <IonItemDivider>Number type input</IonItemDivider>\n          <IonItem>\n            <IonInput type=\"number\" value={number} placeholder=\"Enter Number\" onIonChange={e => setNumber(parseInt(e.detail.value!, 10))}></IonInput>\n          </IonItem>\n\n          <IonItemDivider>Disabled input</IonItemDivider>\n          <IonItem>\n            <IonInput value={text} disabled></IonInput>\n          </IonItem>\n\n          <IonItemDivider>Readonly input</IonItemDivider>\n          <IonItem>\n            <IonInput value={text} readonly></IonInput>\n          </IonItem>\n\n          <IonItemDivider>Inputs with labels</IonItemDivider>\n\n          <IonItem>\n            <IonLabel>Default Label</IonLabel>\n            <IonInput></IonInput>\n          </IonItem>\n\n          <IonItem>\n            <IonLabel position=\"floating\">Floating Label</IonLabel>\n            <IonInput value={text}></IonInput>\n          </IonItem>\n\n          <IonItem>\n            <IonLabel position=\"fixed\">Fixed Label</IonLabel>\n            <IonInput value={text}></IonInput>\n          </IonItem>\n\n          <IonItem>\n            <IonLabel position=\"stacked\">Stacked Label</IonLabel>\n            <IonInput value={text}> </IonInput>\n          </IonItem>\n        </IonList>\n      </IonContent>\n    </IonPage>\n  );\n};","import {\r\n    IonButton,\r\n    IonButtons, \r\n    IonContent, \r\n    IonHeader,\r\n    IonMenuButton,\r\n    IonPage,\r\n    IonTitle,\r\n    IonToolbar} from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { charactersMap } from '../charactermap';\r\nimport { clientApp } from '../ClientApp';\r\nimport { LVListenerList } from '../UIListeners';\r\nimport './Page.css';\r\n\r\nfunction PickCharacterElement(props : {id: number, img : string, isAlreadyPicked: boolean, isSelected: boolean, isPicked: boolean, pickedCharacterCb: (value : number) => void})\r\n{\r\n    function handleClick()\r\n    {\r\n        props.pickedCharacterCb(props.id);\r\n    }\r\n\r\n    return (\r\n        <div className={props.isAlreadyPicked ? \"characterGridCellAlreadyPicked\" :\r\n                        props.isSelected ? \"characterGridCellSelected\" :\r\n                        props.isPicked ? \"characterGridCellPicked\" : \"characterGridCell\"} onClick={handleClick}>\r\n            <img src={\"img/characters/\" + props.img} className=\"characterImg\" onClick={handleClick} alt=\"lol\"/>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction PickCharacterElements(props : {selectedCharacterId: number, alreadyPickedIds: number[], pickedCharacterId: number, pickedCharacterCb: (value : number) => void})\r\n{\r\n    return <>{\r\n        charactersMap.map((characterImg, index) =>\r\n            <PickCharacterElement\r\n                key={index}\r\n                id={index}\r\n                img={characterImg}\r\n                isSelected={props.selectedCharacterId === index}\r\n                isAlreadyPicked={props.alreadyPickedIds.indexOf(index) !== -1}\r\n                isPicked={props.pickedCharacterId === index}\r\n                pickedCharacterCb={props.pickedCharacterCb}\r\n                />\r\n        )\r\n    }</>\r\n}\r\n\r\nconst PickCharacterPage: React.FC = () => {\r\n    const [selectedCharacterId, setSelectedCharacterId] = useState<number>(clientApp.getUiProperty(\"pickedCharacterId\"));\r\n    const [alreadyPickedIds, setAlreadyPickedIds] = useState<number[]>(clientApp.getUiProperty(\"alreadyPickedIds\"));\r\n    const [pickedCharacterId, setPickedCharacterId] = useState<number>(clientApp.getUiProperty(\"pickedCharacterId\"));\r\n    const [pickDisabled, setPickDisabled] = useState<boolean>(false);\r\n\r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"pickCharacter\");\r\n        listeners.onPropertyChange(\"pickedCharacterId\", function(value) { setPickedCharacterId(value); setSelectedCharacterId(value); });\r\n        listeners.onPropertyChange(\"alreadyPickedIds\", (v : number[]) => setAlreadyPickedIds(v));\r\n        listeners.onEvent(\"pickedCharacterInUse\", function () { setPickDisabled(false); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    function handlePickClick()\r\n    {\r\n        setPickDisabled(true);\r\n        clientApp.pickCharacter(selectedCharacterId);\r\n    }\r\n\r\n    function handleCharacterClick(characterId : number)\r\n    {\r\n        setSelectedCharacterId(characterId);\r\n        if (pickedCharacterId !== -1 && characterId !== pickedCharacterId)\r\n        {\r\n            clientApp.clearPickedCharacter();\r\n        }\r\n    }\r\n\r\n    return (\r\n    <IonPage>\r\n        <IonHeader>\r\n            <IonToolbar>\r\n                <IonButtons slot=\"start\">\r\n                    <IonMenuButton />\r\n                </IonButtons>\r\n                <IonTitle>\r\n                    <IonButton\r\n                        disabled={selectedCharacterId === -1 || (pickedCharacterId !== selectedCharacterId && alreadyPickedIds.indexOf(selectedCharacterId) !== -1) || pickDisabled}\r\n                        onClick={handlePickClick}\r\n                        >\r\n                        Pick Character\r\n                    </IonButton>\r\n                </IonTitle>\r\n            </IonToolbar>\r\n        </IonHeader>\r\n\r\n        <IonContent fullscreen>\r\n            <div>\r\n                <div className=\"grid\">\r\n                    <PickCharacterElements selectedCharacterId={selectedCharacterId} alreadyPickedIds={alreadyPickedIds} pickedCharacterId={pickedCharacterId} pickedCharacterCb={handleCharacterClick}/>\r\n                </div>\r\n                <div>Icons made by <a href=\"https://www.flaticon.com/authors/freepik\" title=\"Freepik\">Freepik</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div>\r\n            </div>\r\n        </IonContent>\r\n    </IonPage>\r\n    );\r\n};\r\n\r\nexport default PickCharacterPage;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonInput, IonItem, IonList, IonButton, IonToast } from '@ionic/react';\r\nimport { clientApp } from '../ClientApp';\r\nimport { LVListenerList } from '../UIListeners';\r\n\r\nexport const LoginPage: React.FC = () => {\r\n\r\n    const [name, setName] = useState<string>(clientApp.getUiProperty(\"username\"));\r\n    const [room, setRoom] = useState<string>(clientApp.getUiProperty(\"roomcode\"));\r\n    const [joiningRoom, setJoiningRoom] = useState<string>(\"\");\r\n    const [createRoomEnable, setCreateRoomEnable] = useState<boolean>(true);\r\n    const [joinRoomEnable, setJoinRoomEnable] = useState<boolean>(true);\r\n    const [showToast, setShowToast] = useState<boolean>(false);\r\n\r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"login\");\r\n        listeners.onPropertyChange(\"roomcode\", (value : string) => { setRoom(value); });\r\n        listeners.onEvent(\"connectionError\", function()\r\n        {\r\n            setShowToast(true);\r\n            setJoinRoomEnable(true);\r\n            setCreateRoomEnable(true);\r\n        });\r\n        listeners.onEvent(\"leaveRoom\", function()\r\n        {\r\n            setJoinRoomEnable(true);\r\n            setCreateRoomEnable(true);\r\n        });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    function joinRoom()\r\n    {\r\n        clientApp.joinRoom(name, room);\r\n        setJoinRoomEnable(false);\r\n        setJoiningRoom(room);\r\n    }\r\n    function createRoom()\r\n    {\r\n        setRoom(\"\");\r\n        clientApp.createRoom();\r\n        setCreateRoomEnable(false);\r\n    }\r\n    \r\n    return (\r\n        <IonPage>\r\n            <IonHeader>\r\n                <IonToolbar>\r\n                    <IonTitle>Loveletter</IonTitle>\r\n                </IonToolbar>\r\n            </IonHeader>\r\n            <IonContent>\r\n                <IonList>\r\n                    <IonItem>\r\n                        <IonInput value={name} placeholder=\"NAME\" onIonChange={e => setName(e.detail.value!)} clearInput maxlength={15}></IonInput>\r\n                    </IonItem>\r\n                    <IonItem>\r\n                        <IonInput value={room} placeholder=\"ROOM CODE\" onIonChange={e => setRoom(e.detail.value!)} clearInput maxlength={4} autocapitalize=\"characters\" className=\"uppercase-input\"></IonInput>\r\n                        <IonButton onClick={joinRoom} disabled={!joinRoomEnable || room.length < 4 || name.length < 3}>Join Room</IonButton>\r\n                        <IonButton onClick={createRoom} disabled={!createRoomEnable}>Create Room</IonButton>\r\n                    </IonItem>\r\n                </IonList>\r\n                <IonToast\r\n                    isOpen={showToast}\r\n                    onDidDismiss={() => setShowToast(false)}\r\n                    message={\"Failed connecting to room code \" + joiningRoom + \".\"}\r\n                    duration={5000}\r\n                />\r\n            </IonContent>\r\n            \r\n        </IonPage>\r\n    );\r\n};","import { IonButton, IonButtons, IonContent, IonHeader, IonItem, IonList, IonMenuButton, IonPage, IonTitle, IonToolbar } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { CardType, tokensToWinMap } from '../cards';\r\nimport { clientApp } from '../ClientApp';\r\nimport { CardName, Interaction, InteractionCard, PlayerCharacterName, PlayerDetails, PlayerState } from '../Shared';\r\nimport { LVListenerList } from '../UIListeners';\r\nimport { Tokens } from './GamePage';\r\nimport './Page.css';\r\n\r\nfunction RoundEndPlayersListItem(props : {playerDetails : PlayerDetails, finalCard : CardType | null})\r\n{\r\n    return (\r\n        <div className=\"roundEndPlayerLine\">\r\n            <div className=\"alignLeft\">\r\n                <PlayerCharacterName playerDetails={props.playerDetails} />\r\n            </div>\r\n            {\r\n                props.playerDetails.state === \"DEAD\" ?\r\n                    <div className=\"roundEndPlayerStatus\">\r\n                        <span className=\"middlerHack\"></span>\r\n                        <PlayerState status=\"DEAD\" />\r\n                    </div>\r\n                : (!props.finalCard ? null :\r\n                    <div className=\"alignRight\">\r\n                        <span className=\"middlerHack\"></span>\r\n                        <span className=\"hspacer\"></span><CardName card={props.finalCard!}/>\r\n                    </div>)\r\n            }\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RoundEndPlayersList(props : {playerDetails : PlayerDetails[], finalCards : CardType[]})\r\n{\r\n    return (<>\r\n        {\r\n            props.playerDetails.map((playerDetails, index) =>\r\n            <IonItem key={index}>\r\n                <RoundEndPlayersListItem finalCard={props.finalCards.length > 0 ? props.finalCards[index] : null} playerDetails={playerDetails}/>\r\n            </IonItem>)\r\n        }\r\n        </>\r\n    );\r\n}\r\n\r\nfunction WinnersCards(props : {playerDetails: PlayerDetails[], winnerIds: number[], playerId: number, gameWinner?: number, roomSeed: number})\r\n{\r\n    if (props.gameWinner !== undefined)\r\n    {\r\n        return (\r\n            <>\r\n                <InteractionCard>\r\n                    <PlayerCharacterName playerDetails={props.playerDetails[props.gameWinner]} /> wins the game!\r\n                </InteractionCard>\r\n                <InteractionCard>\r\n                    <Tokens wins={props.playerDetails[props.gameWinner].wins} seed={props.roomSeed + props.gameWinner! * 10} />\r\n                </InteractionCard>\r\n            </>\r\n        );\r\n    }\r\n\r\n    function handleNewRound()\r\n    {\r\n        clientApp.interactionStep();\r\n    }\r\n\r\n    return (\r\n        <>\r\n        {\r\n            props.winnerIds.map((id, index) =>\r\n                <React.Fragment key={id}>\r\n                    <InteractionCard>\r\n                        <PlayerCharacterName playerDetails={props.playerDetails[id]} /> wins the round!\r\n                    </InteractionCard>\r\n                    <InteractionCard>\r\n                        <Tokens wins={props.playerDetails[id].wins} seed={props.roomSeed + id * 10} />\r\n                        <br></br>\r\n                        {tokensToWinMap[props.playerDetails.length] - props.playerDetails[id].wins} more tokens needed to win\r\n                    </InteractionCard>\r\n                    { props.playerId === id ?\r\n                        <InteractionCard>\r\n                            <IonButton onClick={handleNewRound}>New round</IonButton>\r\n                        </InteractionCard> : null\r\n                    }\r\n                </React.Fragment>\r\n            )\r\n        }\r\n        </>\r\n    );\r\n}\r\n\r\nconst RoundCompletePage: React.FC = () => {\r\n\r\n    const [playerDetails, setPlayerDetails] = useState<PlayerDetails[]>(clientApp.getUiProperty(\"playerDetails\"));\r\n    const [playerId, setPlayerId] = useState<number>(clientApp.getUiProperty(\"playerId\"));\r\n    const [interaction, setInteraction] = useState<Interaction>(clientApp.getUiProperty(\"interaction\"));\r\n    const [roomSeed, setRoomSeed] = useState<number>(clientApp.getUiProperty(\"roomSeed\"));\r\n\r\n    useEffect(() => {\r\n        var listeners = new LVListenerList(\"roundComplete\");\r\n        listeners.onPropertyChange(\"playerDetails\", function(value : PlayerDetails[]) { setPlayerDetails(value); });\r\n        listeners.onPropertyChange(\"playerId\", function(value : number) { setPlayerId(value); });\r\n        listeners.onPropertyChange(\"interaction\", function(value : Interaction) { setInteraction(value); });\r\n        listeners.onPropertyChange(\"roomSeed\", function(value : number) { setRoomSeed(value); });\r\n        return clientApp.effectListeners(listeners);\r\n    }, []);\r\n\r\n    return (\r\n        <IonPage>\r\n            <IonContent fullscreen>\r\n                <IonHeader>\r\n                    <IonToolbar>\r\n                        <IonButtons slot=\"start\">\r\n                            <IonMenuButton />\r\n                        </IonButtons>\r\n                        <IonTitle>Round Complete</IonTitle>\r\n                    </IonToolbar>\r\n                </IonHeader>\r\n\r\n                { interaction.status !== \"ROUND_COMPLETE\" ? null :\r\n                    <>\r\n                        <InteractionCard>\r\n                            <IonList>\r\n                                <RoundEndPlayersList finalCards={interaction.finalCards || []} playerDetails={playerDetails}/>\r\n                            </IonList>\r\n                        </InteractionCard>\r\n                        <WinnersCards playerId={playerId} playerDetails={playerDetails} winnerIds={interaction.winnerIds || []} gameWinner={interaction.gameWinner} roomSeed={roomSeed}/>\r\n                    </>\r\n                }\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n}\r\n\r\nexport default RoundCompletePage;","import Menu from './components/Menu';\nimport GameTabPage from './pages/GameTab';\nimport HelpPage from './pages/HelpPage';\nimport { InputExamples } from './pages/Page';\nimport PickCharacterPage from './pages/PickCharacterPage';\nimport { LoginPage } from './pages/LoginPage';\nimport React from 'react';\nimport { IonApp, IonRouterOutlet, IonSplitPane } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\nimport { Redirect, Route } from 'react-router-dom';\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\nimport RoundCompletePage from './pages/RoundComplete';\n\nconst App: React.FC = () => {\n\n  return (\n    <IonApp>\n      <IonReactRouter>\n        <IonSplitPane contentId=\"main\">\n          <Menu />\n          <IonRouterOutlet id=\"main\">\n            <Route path=\"/tabs\" render={() => <GameTabPage />} />\n            <Route path=\"/page/Login\" component={LoginPage} exact />\n            <Route path=\"/page/PickCharacter\" component={PickCharacterPage} exact />\n            <Route path=\"/page/Help\" component={HelpPage} exact />\n            <Route path=\"/page/RoundComplete\" component={RoundCompletePage} exact />\n            <Route path=\"/page/Test\" component={InputExamples} exact />\n            <Redirect from=\"/\" to=\"/page/Login\" exact />\n          </IonRouterOutlet>\n        </IonSplitPane>\n      </IonReactRouter>\n    </IonApp>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}